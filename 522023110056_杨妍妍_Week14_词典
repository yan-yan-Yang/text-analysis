{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "307fe3c7-08cc-4999-afcd-248969ac5c04",
   "metadata": {},
   "source": [
    "# 1.【课程】基于样例语料库的道德词典"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "7f63c893-3d74-4951-bfb7-21b5290da2eb",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Building prefix dict from the default dictionary ...\n",
      "Loading model from cache /var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/jieba.cache\n",
      "Loading model cost 0.510 seconds.\n",
      "Prefix dict has been built successfully.\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd     # 数据表\n",
    "import numpy as np     # 数组\n",
    "import jieba     # 中文分词\n",
    "import moralstrength     # 英文道德词典\n",
    "from moralstrength import lexicon_use\n",
    "from moralstrength.moralstrength import estimate_morals\n",
    "import cmfd     #中文道德词典"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a422a2e0-9e0b-496b-846e-abd17474c544",
   "metadata": {},
   "source": [
    "## 1.1 英文语料-基于英文道德基础词典"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "58bb78cf-b8bb-43ea-9ab8-7d06c7fcc9b0",
   "metadata": {},
   "source": [
    "基于WordNet同义词集建立，利用道德词典并嵌入相似性以对文本进行道德基础预测。相关工作已发表文献（Oscar Araque, Lorenzo Gatti, Kyriaki Kalimeri (2020) MoralStrength: Exploiting a moral lexicon and embedding similarity for moral foundations prediction, Knowledge-Based Systems,Volume 191,105184）。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "57372112-bfa9-4233-993b-3dde7e122b45",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>index</th>\n",
       "      <th>id</th>\n",
       "      <th>screen_name</th>\n",
       "      <th>time</th>\n",
       "      <th>link</th>\n",
       "      <th>text</th>\n",
       "      <th>source</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>49374</td>\n",
       "      <td>890587249372524544</td>\n",
       "      <td>auctnr1</td>\n",
       "      <td>2017-07-27T10:58:41-04:00</td>\n",
       "      <td>https://www.twitter.com/Reuters/statuses/89058...</td>\n",
       "      <td>RT @Reuters MORE: Top U.S. general says, given...</td>\n",
       "      <td>Twitter for iPhone</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>83246</td>\n",
       "      <td>899354463055618048</td>\n",
       "      <td>SenatorTester</td>\n",
       "      <td>2017-08-20T15:36:27-04:00</td>\n",
       "      <td>https://www.twitter.com/SenatorTester/statuses...</td>\n",
       "      <td>T-minus 2 days until our first-ever Last Best ...</td>\n",
       "      <td>Twitter Web Client</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>100988</td>\n",
       "      <td>903272105738985472</td>\n",
       "      <td>KeithRothfus</td>\n",
       "      <td>2017-08-31T11:03:46-04:00</td>\n",
       "      <td>https://www.twitter.com/KeithRothfus/statuses/...</td>\n",
       "      <td>Please know that help is available. Visit http...</td>\n",
       "      <td>Twitter Web Client</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>193395</td>\n",
       "      <td>921001114409021440</td>\n",
       "      <td>HASCRepublicans</td>\n",
       "      <td>2017-10-19T09:12:31-04:00</td>\n",
       "      <td>https://www.twitter.com/HASCRepublicans/status...</td>\n",
       "      <td>Literally flying the wings off the A-10 in fig...</td>\n",
       "      <td>Twitter Web Client</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>12662</td>\n",
       "      <td>884911451449774080</td>\n",
       "      <td>SteveKnight25</td>\n",
       "      <td>2017-07-11T19:05:05-04:00</td>\n",
       "      <td>https://www.twitter.com/SteveKnight25/statuses...</td>\n",
       "      <td>Today the House unanimously passed my bill #HR...</td>\n",
       "      <td>Twitter Web Client</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    index                  id      screen_name                       time  \\\n",
       "0   49374  890587249372524544          auctnr1  2017-07-27T10:58:41-04:00   \n",
       "1   83246  899354463055618048    SenatorTester  2017-08-20T15:36:27-04:00   \n",
       "2  100988  903272105738985472     KeithRothfus  2017-08-31T11:03:46-04:00   \n",
       "3  193395  921001114409021440  HASCRepublicans  2017-10-19T09:12:31-04:00   \n",
       "4   12662  884911451449774080    SteveKnight25  2017-07-11T19:05:05-04:00   \n",
       "\n",
       "                                                link  \\\n",
       "0  https://www.twitter.com/Reuters/statuses/89058...   \n",
       "1  https://www.twitter.com/SenatorTester/statuses...   \n",
       "2  https://www.twitter.com/KeithRothfus/statuses/...   \n",
       "3  https://www.twitter.com/HASCRepublicans/status...   \n",
       "4  https://www.twitter.com/SteveKnight25/statuses...   \n",
       "\n",
       "                                                text              source  \n",
       "0  RT @Reuters MORE: Top U.S. general says, given...  Twitter for iPhone  \n",
       "1  T-minus 2 days until our first-ever Last Best ...  Twitter Web Client  \n",
       "2  Please know that help is available. Visit http...  Twitter Web Client  \n",
       "3  Literally flying the wings off the A-10 in fig...  Twitter Web Client  \n",
       "4  Today the House unanimously passed my bill #HR...  Twitter Web Client  "
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_eng = pd.read_excel('text_analysis_twitter_sample.xlsx', index_col = 0)\n",
    "df_eng.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "fe46d999-f7e3-4792-b869-d28ae11ffd48",
   "metadata": {},
   "outputs": [],
   "source": [
    "lexicon_use.select_version('latest')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "57b109fd-9fb8-45b2-bfa9-64a6da76b0af",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/yangmi/anaconda3/lib/python3.11/site-packages/spacy/pipeline/lemmatizer.py:211: UserWarning: [W108] The rule-based lemmatizer did not find POS annotation for one or more tokens. Check that your pipeline includes components that assign token.pos, typically 'tagger'+'attribute_ruler' or 'morphologizer'.\n",
      "  warnings.warn(Warnings.W108)\n"
     ]
    }
   ],
   "source": [
    "df_eng_morals = estimate_morals(df_eng['text'].tolist(), process=True)\n",
    "df_eng = pd.concat([df_eng, df_eng_morals], axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "9b6c4491-b2ae-472c-ba40-0c72e6fe8703",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>index</th>\n",
       "      <th>id</th>\n",
       "      <th>screen_name</th>\n",
       "      <th>time</th>\n",
       "      <th>link</th>\n",
       "      <th>text</th>\n",
       "      <th>source</th>\n",
       "      <th>care</th>\n",
       "      <th>fairness</th>\n",
       "      <th>loyalty</th>\n",
       "      <th>authority</th>\n",
       "      <th>purity</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>49374</td>\n",
       "      <td>890587249372524544</td>\n",
       "      <td>auctnr1</td>\n",
       "      <td>2017-07-27T10:58:41-04:00</td>\n",
       "      <td>https://www.twitter.com/Reuters/statuses/89058...</td>\n",
       "      <td>RT @Reuters MORE: Top U.S. general says, given...</td>\n",
       "      <td>Twitter for iPhone</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>83246</td>\n",
       "      <td>899354463055618048</td>\n",
       "      <td>SenatorTester</td>\n",
       "      <td>2017-08-20T15:36:27-04:00</td>\n",
       "      <td>https://www.twitter.com/SenatorTester/statuses...</td>\n",
       "      <td>T-minus 2 days until our first-ever Last Best ...</td>\n",
       "      <td>Twitter Web Client</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>100988</td>\n",
       "      <td>903272105738985472</td>\n",
       "      <td>KeithRothfus</td>\n",
       "      <td>2017-08-31T11:03:46-04:00</td>\n",
       "      <td>https://www.twitter.com/KeithRothfus/statuses/...</td>\n",
       "      <td>Please know that help is available. Visit http...</td>\n",
       "      <td>Twitter Web Client</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>193395</td>\n",
       "      <td>921001114409021440</td>\n",
       "      <td>HASCRepublicans</td>\n",
       "      <td>2017-10-19T09:12:31-04:00</td>\n",
       "      <td>https://www.twitter.com/HASCRepublicans/status...</td>\n",
       "      <td>Literally flying the wings off the A-10 in fig...</td>\n",
       "      <td>Twitter Web Client</td>\n",
       "      <td>4.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>12662</td>\n",
       "      <td>884911451449774080</td>\n",
       "      <td>SteveKnight25</td>\n",
       "      <td>2017-07-11T19:05:05-04:00</td>\n",
       "      <td>https://www.twitter.com/SteveKnight25/statuses...</td>\n",
       "      <td>Today the House unanimously passed my bill #HR...</td>\n",
       "      <td>Twitter Web Client</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    index                  id      screen_name                       time  \\\n",
       "0   49374  890587249372524544          auctnr1  2017-07-27T10:58:41-04:00   \n",
       "1   83246  899354463055618048    SenatorTester  2017-08-20T15:36:27-04:00   \n",
       "2  100988  903272105738985472     KeithRothfus  2017-08-31T11:03:46-04:00   \n",
       "3  193395  921001114409021440  HASCRepublicans  2017-10-19T09:12:31-04:00   \n",
       "4   12662  884911451449774080    SteveKnight25  2017-07-11T19:05:05-04:00   \n",
       "\n",
       "                                                link  \\\n",
       "0  https://www.twitter.com/Reuters/statuses/89058...   \n",
       "1  https://www.twitter.com/SenatorTester/statuses...   \n",
       "2  https://www.twitter.com/KeithRothfus/statuses/...   \n",
       "3  https://www.twitter.com/HASCRepublicans/status...   \n",
       "4  https://www.twitter.com/SteveKnight25/statuses...   \n",
       "\n",
       "                                                text              source  \\\n",
       "0  RT @Reuters MORE: Top U.S. general says, given...  Twitter for iPhone   \n",
       "1  T-minus 2 days until our first-ever Last Best ...  Twitter Web Client   \n",
       "2  Please know that help is available. Visit http...  Twitter Web Client   \n",
       "3  Literally flying the wings off the A-10 in fig...  Twitter Web Client   \n",
       "4  Today the House unanimously passed my bill #HR...  Twitter Web Client   \n",
       "\n",
       "   care  fairness  loyalty  authority  purity  \n",
       "0   NaN       NaN      NaN        NaN     NaN  \n",
       "1   NaN       NaN      NaN        NaN     NaN  \n",
       "2   NaN       NaN      NaN        NaN     NaN  \n",
       "3   4.0       NaN      NaN        NaN     NaN  \n",
       "4   NaN       NaN      NaN        NaN     NaN  "
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_eng.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d947bbae-12df-475a-9a35-f79181637269",
   "metadata": {},
   "source": [
    "## 1.2中文语料-基于汉语基础道德词典cmfd"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "997c9937-19f8-482c-87dd-04dfc2e7ee73",
   "metadata": {},
   "source": [
    "中文道德基础词典（C-MFD）是一本辅助中文语境中自动检测和分析道德直觉的词典。两位专家从现有的中文翻译开始，选择了更多的中国道德概念，并使用word2vec从广泛的中文词典中获取相关单词。四位专家进行了四轮编码，随后进行了 202 名众包编码员的验证。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "2bc4b8ba-0d75-4406-9419-9a4c680b8d55",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>index</th>\n",
       "      <th>商品名称</th>\n",
       "      <th>商品类别</th>\n",
       "      <th>出版年</th>\n",
       "      <th>广告文本</th>\n",
       "      <th>广告标题</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1596</td>\n",
       "      <td>五华牌香烟[May Blossom]</td>\n",
       "      <td>烟草制品</td>\n",
       "      <td>1932</td>\n",
       "      <td>兰勃脱白脱勒公司 五华牌香烟 佛及尼埃香烟  二十枝装每包售国币大洋二角 五十枝装每罐售国币...</td>\n",
       "      <td>五华牌香烟,\"兰勃脱白脱勒公司 五华牌香烟 佛及尼埃香烟\"</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>5627</td>\n",
       "      <td>韦廉士红色清导丸[Dr.Willams' Pink Pills For Pale People]</td>\n",
       "      <td>药品</td>\n",
       "      <td>1918</td>\n",
       "      <td>讲求卫生为人生本性天理固然也 人生首贵逐日大便通畅有序为天然所当如此也如若大便不利大肠阻塞则...</td>\n",
       "      <td>韦廉士红色清导丸:'讲求卫生为人生本性天理固然也'</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>13532</td>\n",
       "      <td>大炮台香烟[Three Castles Cigarettes]</td>\n",
       "      <td>烟草制品</td>\n",
       "      <td>1935</td>\n",
       "      <td>香味馥郁,不让名花 另有三炮台出售</td>\n",
       "      <td>大炮台香烟,\"香味馥郁 不让名花\"</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1133</td>\n",
       "      <td>婴孩自己药片[Baby's Own]</td>\n",
       "      <td>药品</td>\n",
       "      <td>1930</td>\n",
       "      <td>差肩儿女 秀慧康强 闽有佳音讃羡婴孩自己药片 每年此际小儿患肠胃病者甚多而尤以南方各地天气翳...</td>\n",
       "      <td>婴孩自己药片,\"差肩儿女 秀慧康强 闽有佳音赞美婴孩自己药片\"</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>3146</td>\n",
       "      <td>亚士北罗药片[Aspro]</td>\n",
       "      <td>药品</td>\n",
       "      <td>1933</td>\n",
       "      <td>何以亚士北罗是妇女们的腻友？各国妇女力证亚士北罗药片是她们最需要的药物！为什么？她们的经验知...</td>\n",
       "      <td>亚士北罗药片,\"妇女之腻友\"</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   index                                              商品名称  商品类别   出版年  \\\n",
       "0   1596                                五华牌香烟[May Blossom]  烟草制品  1932   \n",
       "1   5627  韦廉士红色清导丸[Dr.Willams' Pink Pills For Pale People]    药品  1918   \n",
       "2  13532                   大炮台香烟[Three Castles Cigarettes]  烟草制品  1935   \n",
       "3   1133                                婴孩自己药片[Baby's Own]    药品  1930   \n",
       "4   3146                                     亚士北罗药片[Aspro]    药品  1933   \n",
       "\n",
       "                                                广告文本  \\\n",
       "0  兰勃脱白脱勒公司 五华牌香烟 佛及尼埃香烟  二十枝装每包售国币大洋二角 五十枝装每罐售国币...   \n",
       "1  讲求卫生为人生本性天理固然也 人生首贵逐日大便通畅有序为天然所当如此也如若大便不利大肠阻塞则...   \n",
       "2                                  香味馥郁,不让名花 另有三炮台出售   \n",
       "3  差肩儿女 秀慧康强 闽有佳音讃羡婴孩自己药片 每年此际小儿患肠胃病者甚多而尤以南方各地天气翳...   \n",
       "4  何以亚士北罗是妇女们的腻友？各国妇女力证亚士北罗药片是她们最需要的药物！为什么？她们的经验知...   \n",
       "\n",
       "                              广告标题  \n",
       "0    五华牌香烟,\"兰勃脱白脱勒公司 五华牌香烟 佛及尼埃香烟\"  \n",
       "1        韦廉士红色清导丸:'讲求卫生为人生本性天理固然也'  \n",
       "2                大炮台香烟,\"香味馥郁 不让名花\"  \n",
       "3  婴孩自己药片,\"差肩儿女 秀慧康强 闽有佳音赞美婴孩自己药片\"  \n",
       "4                   亚士北罗药片,\"妇女之腻友\"  "
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_chn = pd.read_excel('text_analysis_ad.xlsx', index_col = 0)\n",
    "df_chn.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "3b4aed0b-1286-4208-a1ae-0d53e9f1a13e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>chinese</th>\n",
       "      <th>foundation</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>同情</td>\n",
       "      <td>care</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>一臂之力</td>\n",
       "      <td>care</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>一见倾心</td>\n",
       "      <td>care</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>三个代表</td>\n",
       "      <td>care</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>上阵杀敌</td>\n",
       "      <td>care</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6133</th>\n",
       "      <td>随和</td>\n",
       "      <td>general</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6134</th>\n",
       "      <td>雅正</td>\n",
       "      <td>general</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6135</th>\n",
       "      <td>雷打不动</td>\n",
       "      <td>general</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6136</th>\n",
       "      <td>马马虎虎</td>\n",
       "      <td>general</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6137</th>\n",
       "      <td>骨节</td>\n",
       "      <td>general</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>6138 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     chinese foundation\n",
       "0         同情       care\n",
       "1       一臂之力       care\n",
       "2       一见倾心       care\n",
       "3       三个代表       care\n",
       "4       上阵杀敌       care\n",
       "...      ...        ...\n",
       "6133      随和    general\n",
       "6134      雅正    general\n",
       "6135    雷打不动    general\n",
       "6136    马马虎虎    general\n",
       "6137      骨节    general\n",
       "\n",
       "[6138 rows x 2 columns]"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "chn_moral = pd.read_csv(r'https://raw.githubusercontent.com/CivicTechLab/CMFD/main/cmfd_civictech.csv')\n",
    "chn_moral"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "01bef305-fa83-4b13-89c6-d87b32696a74",
   "metadata": {},
   "outputs": [],
   "source": [
    "moral_dict = chn_moral.groupby('foundation')['chinese'].apply(list).to_dict()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "60c5c612-3e81-462f-94c7-14409b9d1af7",
   "metadata": {},
   "outputs": [],
   "source": [
    "# moral_dict\n",
    "def moral_quantity(text):\n",
    "    \n",
    "    if isinstance(text, str):\n",
    "        moral_word_total = 0\n",
    "        moral_word = {}\n",
    "        moral_num = {}\n",
    "\n",
    "        for key in moral_dict.keys():\n",
    "            moral_word[key] = []\n",
    "        for word in jieba.cut(text):\n",
    "            for key in moral_dict.keys():\n",
    "                if word in moral_dict[key]:\n",
    "                    moral_word[key].append(word)\n",
    "\n",
    "        for key in moral_word.keys():\n",
    "            moral_word_total += len(moral_word[key])\n",
    "        if moral_word_total == 0:\n",
    "            return None\n",
    "\n",
    "        for key in moral_word.keys():\n",
    "            moral_num[key] = len(moral_word[key]) / moral_word_total\n",
    "\n",
    "    return moral_num"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "09729733-c801-4bd4-b5a5-86b2024dae04",
   "metadata": {},
   "outputs": [],
   "source": [
    "text_test = \"\"\"在一个古老的王国里，有一位年轻的王子，名叫艾伦。他爱上了王国中一个普通的女孩，名叫艾丽丝。然而，王子的父亲，即国王，却不同意这段感情，因为他认为艾丽丝的出身不够高贵，不适合成为王室的一员。\n",
    "\n",
    "王子面临着艰难的选择，他可以违抗父王的意愿和艾丽丝在一起，但这意味着他要放弃王位和王国的责任。另一方面，他也可以遵从父王的意愿，选择一个地位高贵但他并不爱的女子，这样可以继续承担王国的责任。\n",
    "\n",
    "在经过深思熟虑后，王子决定选择违抗父王的意愿，选择与艾丽丝在一起。他认为爱情比地位和财富更重要，而且他也相信只有在爱情的支持下，他才能成为一个真正的幸福的国王。\n",
    "\n",
    "尽管他的决定引起了一些争议和反对，但王子坚持了自己的选择，并与艾丽丝结为夫妻。他们的爱情和幸福成为了王国中的典范，人们开始理解和尊重不同阶层之间的爱情，认识到爱情是超越地位和财富的。\"\"\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "631c8c8e-10ac-46dc-960d-9ac6c757eea9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'altr': 0.0,\n",
       " 'auth': 0.5161290322580645,\n",
       " 'care': 0.06451612903225806,\n",
       " 'dili': 0.0,\n",
       " 'fair': 0.0,\n",
       " 'general': 0.06451612903225806,\n",
       " 'libe': 0.0,\n",
       " 'loya': 0.12903225806451613,\n",
       " 'mode': 0.03225806451612903,\n",
       " 'resi': 0.03225806451612903,\n",
       " 'sanc': 0.16129032258064516,\n",
       " 'wast': 0.0}"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "moral_quantity(text_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "8b69c1aa-d57c-4b4f-b196-7a14b16b0358",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>index</th>\n",
       "      <th>商品名称</th>\n",
       "      <th>商品类别</th>\n",
       "      <th>出版年</th>\n",
       "      <th>广告文本</th>\n",
       "      <th>广告标题</th>\n",
       "      <th>chn_moral</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1596</td>\n",
       "      <td>五华牌香烟[May Blossom]</td>\n",
       "      <td>烟草制品</td>\n",
       "      <td>1932</td>\n",
       "      <td>兰勃脱白脱勒公司 五华牌香烟 佛及尼埃香烟  二十枝装每包售国币大洋二角 五十枝装每罐售国币...</td>\n",
       "      <td>五华牌香烟,\"兰勃脱白脱勒公司 五华牌香烟 佛及尼埃香烟\"</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>5627</td>\n",
       "      <td>韦廉士红色清导丸[Dr.Willams' Pink Pills For Pale People]</td>\n",
       "      <td>药品</td>\n",
       "      <td>1918</td>\n",
       "      <td>讲求卫生为人生本性天理固然也 人生首贵逐日大便通畅有序为天然所当如此也如若大便不利大肠阻塞则...</td>\n",
       "      <td>韦廉士红色清导丸:'讲求卫生为人生本性天理固然也'</td>\n",
       "      <td>{'altr': 0.0, 'auth': 0.25, 'care': 0.25, 'dil...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>13532</td>\n",
       "      <td>大炮台香烟[Three Castles Cigarettes]</td>\n",
       "      <td>烟草制品</td>\n",
       "      <td>1935</td>\n",
       "      <td>香味馥郁,不让名花 另有三炮台出售</td>\n",
       "      <td>大炮台香烟,\"香味馥郁 不让名花\"</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1133</td>\n",
       "      <td>婴孩自己药片[Baby's Own]</td>\n",
       "      <td>药品</td>\n",
       "      <td>1930</td>\n",
       "      <td>差肩儿女 秀慧康强 闽有佳音讃羡婴孩自己药片 每年此际小儿患肠胃病者甚多而尤以南方各地天气翳...</td>\n",
       "      <td>婴孩自己药片,\"差肩儿女 秀慧康强 闽有佳音赞美婴孩自己药片\"</td>\n",
       "      <td>{'altr': 0.0, 'auth': 0.2, 'care': 0.2, 'dili'...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>3146</td>\n",
       "      <td>亚士北罗药片[Aspro]</td>\n",
       "      <td>药品</td>\n",
       "      <td>1933</td>\n",
       "      <td>何以亚士北罗是妇女们的腻友？各国妇女力证亚士北罗药片是她们最需要的药物！为什么？她们的经验知...</td>\n",
       "      <td>亚士北罗药片,\"妇女之腻友\"</td>\n",
       "      <td>{'altr': 0.0, 'auth': 0.16666666666666666, 'ca...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   index                                              商品名称  商品类别   出版年  \\\n",
       "0   1596                                五华牌香烟[May Blossom]  烟草制品  1932   \n",
       "1   5627  韦廉士红色清导丸[Dr.Willams' Pink Pills For Pale People]    药品  1918   \n",
       "2  13532                   大炮台香烟[Three Castles Cigarettes]  烟草制品  1935   \n",
       "3   1133                                婴孩自己药片[Baby's Own]    药品  1930   \n",
       "4   3146                                     亚士北罗药片[Aspro]    药品  1933   \n",
       "\n",
       "                                                广告文本  \\\n",
       "0  兰勃脱白脱勒公司 五华牌香烟 佛及尼埃香烟  二十枝装每包售国币大洋二角 五十枝装每罐售国币...   \n",
       "1  讲求卫生为人生本性天理固然也 人生首贵逐日大便通畅有序为天然所当如此也如若大便不利大肠阻塞则...   \n",
       "2                                  香味馥郁,不让名花 另有三炮台出售   \n",
       "3  差肩儿女 秀慧康强 闽有佳音讃羡婴孩自己药片 每年此际小儿患肠胃病者甚多而尤以南方各地天气翳...   \n",
       "4  何以亚士北罗是妇女们的腻友？各国妇女力证亚士北罗药片是她们最需要的药物！为什么？她们的经验知...   \n",
       "\n",
       "                              广告标题  \\\n",
       "0    五华牌香烟,\"兰勃脱白脱勒公司 五华牌香烟 佛及尼埃香烟\"   \n",
       "1        韦廉士红色清导丸:'讲求卫生为人生本性天理固然也'   \n",
       "2                大炮台香烟,\"香味馥郁 不让名花\"   \n",
       "3  婴孩自己药片,\"差肩儿女 秀慧康强 闽有佳音赞美婴孩自己药片\"   \n",
       "4                   亚士北罗药片,\"妇女之腻友\"   \n",
       "\n",
       "                                           chn_moral  \n",
       "0                                               None  \n",
       "1  {'altr': 0.0, 'auth': 0.25, 'care': 0.25, 'dil...  \n",
       "2                                               None  \n",
       "3  {'altr': 0.0, 'auth': 0.2, 'care': 0.2, 'dili'...  \n",
       "4  {'altr': 0.0, 'auth': 0.16666666666666666, 'ca...  "
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_chn['chn_moral'] = df_chn['广告文本'].apply(moral_quantity)\n",
    "df_chn.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "efda8fa9-eb6f-4dd4-965a-71fef03dcede",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:7: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = list(df_chn['chn_moral'][dc].values())\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
      "/var/folders/87/6c4tjldn0b9bqgff58m4gx540000gn/T/ipykernel_2591/2112493011.py:5: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.\n",
      "  chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>index</th>\n",
       "      <th>商品名称</th>\n",
       "      <th>商品类别</th>\n",
       "      <th>出版年</th>\n",
       "      <th>广告文本</th>\n",
       "      <th>广告标题</th>\n",
       "      <th>chn_moral</th>\n",
       "      <th>altr</th>\n",
       "      <th>auth</th>\n",
       "      <th>care</th>\n",
       "      <th>dili</th>\n",
       "      <th>fair</th>\n",
       "      <th>general</th>\n",
       "      <th>libe</th>\n",
       "      <th>loya</th>\n",
       "      <th>mode</th>\n",
       "      <th>resi</th>\n",
       "      <th>sanc</th>\n",
       "      <th>wast</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1596</td>\n",
       "      <td>五华牌香烟[May Blossom]</td>\n",
       "      <td>烟草制品</td>\n",
       "      <td>1932</td>\n",
       "      <td>兰勃脱白脱勒公司 五华牌香烟 佛及尼埃香烟  二十枝装每包售国币大洋二角 五十枝装每罐售国币...</td>\n",
       "      <td>五华牌香烟,\"兰勃脱白脱勒公司 五华牌香烟 佛及尼埃香烟\"</td>\n",
       "      <td>None</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>5627</td>\n",
       "      <td>韦廉士红色清导丸[Dr.Willams' Pink Pills For Pale People]</td>\n",
       "      <td>药品</td>\n",
       "      <td>1918</td>\n",
       "      <td>讲求卫生为人生本性天理固然也 人生首贵逐日大便通畅有序为天然所当如此也如若大便不利大肠阻塞则...</td>\n",
       "      <td>韦廉士红色清导丸:'讲求卫生为人生本性天理固然也'</td>\n",
       "      <td>{'altr': 0.0, 'auth': 0.25, 'care': 0.25, 'dil...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>13532</td>\n",
       "      <td>大炮台香烟[Three Castles Cigarettes]</td>\n",
       "      <td>烟草制品</td>\n",
       "      <td>1935</td>\n",
       "      <td>香味馥郁,不让名花 另有三炮台出售</td>\n",
       "      <td>大炮台香烟,\"香味馥郁 不让名花\"</td>\n",
       "      <td>None</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1133</td>\n",
       "      <td>婴孩自己药片[Baby's Own]</td>\n",
       "      <td>药品</td>\n",
       "      <td>1930</td>\n",
       "      <td>差肩儿女 秀慧康强 闽有佳音讃羡婴孩自己药片 每年此际小儿患肠胃病者甚多而尤以南方各地天气翳...</td>\n",
       "      <td>婴孩自己药片,\"差肩儿女 秀慧康强 闽有佳音赞美婴孩自己药片\"</td>\n",
       "      <td>{'altr': 0.0, 'auth': 0.2, 'care': 0.2, 'dili'...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>3146</td>\n",
       "      <td>亚士北罗药片[Aspro]</td>\n",
       "      <td>药品</td>\n",
       "      <td>1933</td>\n",
       "      <td>何以亚士北罗是妇女们的腻友？各国妇女力证亚士北罗药片是她们最需要的药物！为什么？她们的经验知...</td>\n",
       "      <td>亚士北罗药片,\"妇女之腻友\"</td>\n",
       "      <td>{'altr': 0.0, 'auth': 0.16666666666666666, 'ca...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.166667</td>\n",
       "      <td>0.166667</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.055556</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.388889</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.222222</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   index                                              商品名称  商品类别   出版年  \\\n",
       "0   1596                                五华牌香烟[May Blossom]  烟草制品  1932   \n",
       "1   5627  韦廉士红色清导丸[Dr.Willams' Pink Pills For Pale People]    药品  1918   \n",
       "2  13532                   大炮台香烟[Three Castles Cigarettes]  烟草制品  1935   \n",
       "3   1133                                婴孩自己药片[Baby's Own]    药品  1930   \n",
       "4   3146                                     亚士北罗药片[Aspro]    药品  1933   \n",
       "\n",
       "                                                广告文本  \\\n",
       "0  兰勃脱白脱勒公司 五华牌香烟 佛及尼埃香烟  二十枝装每包售国币大洋二角 五十枝装每罐售国币...   \n",
       "1  讲求卫生为人生本性天理固然也 人生首贵逐日大便通畅有序为天然所当如此也如若大便不利大肠阻塞则...   \n",
       "2                                  香味馥郁,不让名花 另有三炮台出售   \n",
       "3  差肩儿女 秀慧康强 闽有佳音讃羡婴孩自己药片 每年此际小儿患肠胃病者甚多而尤以南方各地天气翳...   \n",
       "4  何以亚士北罗是妇女们的腻友？各国妇女力证亚士北罗药片是她们最需要的药物！为什么？她们的经验知...   \n",
       "\n",
       "                              广告标题  \\\n",
       "0    五华牌香烟,\"兰勃脱白脱勒公司 五华牌香烟 佛及尼埃香烟\"   \n",
       "1        韦廉士红色清导丸:'讲求卫生为人生本性天理固然也'   \n",
       "2                大炮台香烟,\"香味馥郁 不让名花\"   \n",
       "3  婴孩自己药片,\"差肩儿女 秀慧康强 闽有佳音赞美婴孩自己药片\"   \n",
       "4                   亚士北罗药片,\"妇女之腻友\"   \n",
       "\n",
       "                                           chn_moral  altr      auth  \\\n",
       "0                                               None   NaN       NaN   \n",
       "1  {'altr': 0.0, 'auth': 0.25, 'care': 0.25, 'dil...   0.0  0.250000   \n",
       "2                                               None   NaN       NaN   \n",
       "3  {'altr': 0.0, 'auth': 0.2, 'care': 0.2, 'dili'...   0.0  0.200000   \n",
       "4  {'altr': 0.0, 'auth': 0.16666666666666666, 'ca...   0.0  0.166667   \n",
       "\n",
       "       care  dili      fair  general  libe      loya  mode  resi      sanc  \\\n",
       "0       NaN   NaN       NaN      NaN   NaN       NaN   NaN   NaN       NaN   \n",
       "1  0.250000   0.0  0.000000      0.0   0.0  0.000000   0.0   0.0  0.500000   \n",
       "2       NaN   NaN       NaN      NaN   NaN       NaN   NaN   NaN       NaN   \n",
       "3  0.200000   0.0  0.000000      0.0   0.0  0.200000   0.2   0.0  0.200000   \n",
       "4  0.166667   0.0  0.055556      0.0   0.0  0.388889   0.0   0.0  0.222222   \n",
       "\n",
       "   wast  \n",
       "0   NaN  \n",
       "1   0.0  \n",
       "2   NaN  \n",
       "3   0.0  \n",
       "4   0.0  "
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "chn_moral_df = pd.DataFrame(columns=['altr', 'auth', 'care', 'dili', 'fair', 'general', 'libe', 'loya', 'mode', 'resi', 'sanc', 'wast'])\n",
    "\n",
    "for dc in df_chn.index:\n",
    "    if df_chn['chn_moral'][dc] == None:\n",
    "        chn_moral_df.loc[len(chn_moral_df.index)] = [None] * 12\n",
    "    else:\n",
    "        chn_moral_df.loc[len(chn_moral_df.index)] = list(df_chn['chn_moral'][dc].values())\n",
    "        \n",
    "df_chn = pd.concat([df_chn, chn_moral_df], axis=1)\n",
    "        \n",
    "df_chn.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "2a1f8b66-626d-4a21-ba19-642a59b6a40f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['index', '商品名称', '商品类别', '出版年', '广告文本', '广告标题', 'chn_moral', 'altr',\n",
       "       'auth', 'care', 'dili', 'fair', 'general', 'libe', 'loya', 'mode',\n",
       "       'resi', 'sanc', 'wast'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_chn.columns"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d16540ba-d644-4639-aaa8-3df863321da9",
   "metadata": {},
   "source": [
    "# 2.【课程】基于样例语料库的情感词典"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5730f5a8-692f-42a0-a381-074c4eb1c1e2",
   "metadata": {},
   "source": [
    "## 2.1 英文语料-NRC情感词典"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5ed08815-1171-482d-a5f4-0ef8fd072a8d",
   "metadata": {},
   "source": [
    "NRC词典为加拿大国家研究委员会信息技术研究所(Institute for Information Technology, National Research Council Canada. )组织制作的基于众包方式标注出的词典。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "3e443e7e-9daf-4d64-96c3-3a5a81495c2b",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/yangmi/anaconda3/lib/python3.11/site-packages/openpyxl/worksheet/_read_only.py:79: UserWarning: Unknown extension is not supported and will be removed\n",
      "  for idx, row in parser.parse():\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Engword</th>\n",
       "      <th>Chnword</th>\n",
       "      <th>Positive</th>\n",
       "      <th>Negative</th>\n",
       "      <th>Anger</th>\n",
       "      <th>Anticipation</th>\n",
       "      <th>Disgust</th>\n",
       "      <th>Fear</th>\n",
       "      <th>Joy</th>\n",
       "      <th>Sadness</th>\n",
       "      <th>Surprise</th>\n",
       "      <th>Trust</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>aback</td>\n",
       "      <td>吓了一跳</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>abacus</td>\n",
       "      <td>算盘</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>abandon</td>\n",
       "      <td>放弃</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>abandoned</td>\n",
       "      <td>弃</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>abandonment</td>\n",
       "      <td>放弃</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       Engword Chnword  Positive  Negative  Anger  Anticipation  Disgust  \\\n",
       "0        aback    吓了一跳         0         0      0             0        0   \n",
       "1       abacus      算盘         0         0      0             0        0   \n",
       "2      abandon      放弃         0         1      0             0        0   \n",
       "3    abandoned       弃         0         1      1             0        0   \n",
       "4  abandonment      放弃         0         1      1             0        0   \n",
       "\n",
       "   Fear  Joy  Sadness  Surprise  Trust  \n",
       "0     0    0        0         0      0  \n",
       "1     0    0        0         0      1  \n",
       "2     1    0        1         0      0  \n",
       "3     1    0        1         0      0  \n",
       "4     1    0        1         1      0  "
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nrc = pd.read_excel('NRC-Emotion-Lexicon.xlsx', usecols='A, F, AP:AY')\n",
    "nrc = nrc.rename(columns={'English Word':'Engword', 'Chinese (simplified) Translation (Google Translate)':'Chnword'})\n",
    "nrc.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "99eeca2b-15af-4292-b8e5-31931dea5c3e",
   "metadata": {},
   "outputs": [],
   "source": [
    "Positive, Negative, Anger, Anticipation, Disgust, Fear, Joy, Sadness, Surprise, Trust = [], [], [], [], [], [], [], [], [], []\n",
    "\n",
    "for idx, row in nrc.iterrows():\n",
    "    if row['Positive'] == 1:\n",
    "        Positive.append(row['Engword'])\n",
    "    if row['Negative'] == 1:\n",
    "        Negative.append(row['Engword'])\n",
    "    if row['Anger'] == 1:\n",
    "        Anger.append(row['Engword'])\n",
    "    if row['Anticipation'] == 1:\n",
    "        Anticipation.append(row['Engword'])\n",
    "    if row['Disgust'] == 1:\n",
    "        Disgust.append(row['Engword'])\n",
    "    if row['Fear'] == 1:\n",
    "        Fear.append(row['Engword'])\n",
    "    if row['Joy'] == 1:\n",
    "        Joy.append(row['Engword'])\n",
    "    if row['Sadness'] == 1:\n",
    "        Sadness.append(row['Engword'])\n",
    "    if row['Surprise'] == 1:\n",
    "        Surprise.append(row['Engword'])\n",
    "    if row['Trust'] == 1:\n",
    "        Trust.append(row['Engword'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "0ef8c443-b775-4645-96a1-b6263e79b0eb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>length_nrc</th>\n",
       "      <th>positive_nrc</th>\n",
       "      <th>negative_nrc</th>\n",
       "      <th>anger_nrc</th>\n",
       "      <th>anticipation_nrc</th>\n",
       "      <th>disgust_nrc</th>\n",
       "      <th>fear_nrc</th>\n",
       "      <th>joy_nrc</th>\n",
       "      <th>sadness_nrc</th>\n",
       "      <th>surprise_nrc</th>\n",
       "      <th>trust_nrc</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>22</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>18</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>16</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>22</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>20</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  length_nrc positive_nrc negative_nrc anger_nrc anticipation_nrc disgust_nrc  \\\n",
       "0         22            2            0         0                1           0   \n",
       "1         18            1            0         0                1           0   \n",
       "2         16            1            0         0                0           0   \n",
       "3         22            1            1         1                0           0   \n",
       "4         20            0            1         1                0           1   \n",
       "\n",
       "  fear_nrc joy_nrc sadness_nrc surprise_nrc trust_nrc  \n",
       "0        0       0           0            0         2  \n",
       "1        0       1           0            1         1  \n",
       "2        0       0           0            0         0  \n",
       "3        2       0           0            0         0  \n",
       "4        1       0           1            1         1  "
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "emo_nrc_eng = pd.DataFrame(columns=['length_nrc', 'positive_nrc', 'negative_nrc',\n",
    "                                    'anger_nrc', 'anticipation_nrc', 'disgust_nrc', 'fear_nrc',\n",
    "                                    'joy_nrc', 'sadness_nrc', 'surprise_nrc', 'trust_nrc'])\n",
    "\n",
    "for de in df_eng.index:\n",
    "    positive, negative, anger, anticipation, disgust, fear, joy, sadness, surprise, trust = 0, 0, 0, 0, 0, 0, 0, 0, 0, 0\n",
    "    text = df_eng['text'][de].lower()\n",
    "    wordlist = text.split()\n",
    "    wordset = set(wordlist)\n",
    "    wordfreq = []\n",
    "    \n",
    "    for word in wordset:\n",
    "        freq = wordlist.count(word)\n",
    "        if word in Positive:\n",
    "            positive += freq\n",
    "        if word in Negative:\n",
    "            negative += freq\n",
    "        if word in Anger:\n",
    "            anger += freq\n",
    "        if word in Anticipation:\n",
    "            anticipation += freq\n",
    "        if word in Disgust:\n",
    "            disgust += freq\n",
    "        if word in Fear:\n",
    "            fear += freq\n",
    "        if word in Joy:\n",
    "            joy += freq\n",
    "        if word in Sadness:\n",
    "            sadness += freq\n",
    "        if word in Surprise:\n",
    "            surprise += freq\n",
    "        if word in Trust:\n",
    "            trust += freq\n",
    "            \n",
    "    emotion_info = {\n",
    "        'length_nrc': len(wordlist),\n",
    "        'positive_nrc': positive,\n",
    "        'negative_nrc': negative,\n",
    "        'anger_nrc': anger,\n",
    "        'anticipation_nrc': anticipation,\n",
    "        'disgust_nrc': disgust,\n",
    "        'fear_nrc': fear,\n",
    "        'joy_nrc': joy,\n",
    "        'sadness_nrc': sadness,\n",
    "        'surprise_nrc': surprise,\n",
    "        'trust_nrc': trust\n",
    "    }\n",
    "    \n",
    "    emo_info = pd.DataFrame([emotion_info])\n",
    "    emo_nrc_eng = pd.concat([emo_nrc_eng, emo_info], ignore_index=True)\n",
    "    \n",
    "emo_nrc_eng.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "bef0c6d9-ca9a-4f49-b1f7-175e26915ed9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>index</th>\n",
       "      <th>id</th>\n",
       "      <th>screen_name</th>\n",
       "      <th>time</th>\n",
       "      <th>link</th>\n",
       "      <th>text</th>\n",
       "      <th>source</th>\n",
       "      <th>care</th>\n",
       "      <th>fairness</th>\n",
       "      <th>loyalty</th>\n",
       "      <th>...</th>\n",
       "      <th>positive_nrc</th>\n",
       "      <th>negative_nrc</th>\n",
       "      <th>anger_nrc</th>\n",
       "      <th>anticipation_nrc</th>\n",
       "      <th>disgust_nrc</th>\n",
       "      <th>fear_nrc</th>\n",
       "      <th>joy_nrc</th>\n",
       "      <th>sadness_nrc</th>\n",
       "      <th>surprise_nrc</th>\n",
       "      <th>trust_nrc</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>49374</td>\n",
       "      <td>890587249372524544</td>\n",
       "      <td>auctnr1</td>\n",
       "      <td>2017-07-27T10:58:41-04:00</td>\n",
       "      <td>https://www.twitter.com/Reuters/statuses/89058...</td>\n",
       "      <td>RT @Reuters MORE: Top U.S. general says, given...</td>\n",
       "      <td>Twitter for iPhone</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>83246</td>\n",
       "      <td>899354463055618048</td>\n",
       "      <td>SenatorTester</td>\n",
       "      <td>2017-08-20T15:36:27-04:00</td>\n",
       "      <td>https://www.twitter.com/SenatorTester/statuses...</td>\n",
       "      <td>T-minus 2 days until our first-ever Last Best ...</td>\n",
       "      <td>Twitter Web Client</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>100988</td>\n",
       "      <td>903272105738985472</td>\n",
       "      <td>KeithRothfus</td>\n",
       "      <td>2017-08-31T11:03:46-04:00</td>\n",
       "      <td>https://www.twitter.com/KeithRothfus/statuses/...</td>\n",
       "      <td>Please know that help is available. Visit http...</td>\n",
       "      <td>Twitter Web Client</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>193395</td>\n",
       "      <td>921001114409021440</td>\n",
       "      <td>HASCRepublicans</td>\n",
       "      <td>2017-10-19T09:12:31-04:00</td>\n",
       "      <td>https://www.twitter.com/HASCRepublicans/status...</td>\n",
       "      <td>Literally flying the wings off the A-10 in fig...</td>\n",
       "      <td>Twitter Web Client</td>\n",
       "      <td>4.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>12662</td>\n",
       "      <td>884911451449774080</td>\n",
       "      <td>SteveKnight25</td>\n",
       "      <td>2017-07-11T19:05:05-04:00</td>\n",
       "      <td>https://www.twitter.com/SteveKnight25/statuses...</td>\n",
       "      <td>Today the House unanimously passed my bill #HR...</td>\n",
       "      <td>Twitter Web Client</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 23 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    index                  id      screen_name                       time  \\\n",
       "0   49374  890587249372524544          auctnr1  2017-07-27T10:58:41-04:00   \n",
       "1   83246  899354463055618048    SenatorTester  2017-08-20T15:36:27-04:00   \n",
       "2  100988  903272105738985472     KeithRothfus  2017-08-31T11:03:46-04:00   \n",
       "3  193395  921001114409021440  HASCRepublicans  2017-10-19T09:12:31-04:00   \n",
       "4   12662  884911451449774080    SteveKnight25  2017-07-11T19:05:05-04:00   \n",
       "\n",
       "                                                link  \\\n",
       "0  https://www.twitter.com/Reuters/statuses/89058...   \n",
       "1  https://www.twitter.com/SenatorTester/statuses...   \n",
       "2  https://www.twitter.com/KeithRothfus/statuses/...   \n",
       "3  https://www.twitter.com/HASCRepublicans/status...   \n",
       "4  https://www.twitter.com/SteveKnight25/statuses...   \n",
       "\n",
       "                                                text              source  \\\n",
       "0  RT @Reuters MORE: Top U.S. general says, given...  Twitter for iPhone   \n",
       "1  T-minus 2 days until our first-ever Last Best ...  Twitter Web Client   \n",
       "2  Please know that help is available. Visit http...  Twitter Web Client   \n",
       "3  Literally flying the wings off the A-10 in fig...  Twitter Web Client   \n",
       "4  Today the House unanimously passed my bill #HR...  Twitter Web Client   \n",
       "\n",
       "   care  fairness  loyalty  ...  positive_nrc  negative_nrc anger_nrc  \\\n",
       "0   NaN       NaN      NaN  ...             2             0         0   \n",
       "1   NaN       NaN      NaN  ...             1             0         0   \n",
       "2   NaN       NaN      NaN  ...             1             0         0   \n",
       "3   4.0       NaN      NaN  ...             1             1         1   \n",
       "4   NaN       NaN      NaN  ...             0             1         1   \n",
       "\n",
       "  anticipation_nrc disgust_nrc fear_nrc joy_nrc sadness_nrc surprise_nrc  \\\n",
       "0                1           0        0       0           0            0   \n",
       "1                1           0        0       1           0            1   \n",
       "2                0           0        0       0           0            0   \n",
       "3                0           0        2       0           0            0   \n",
       "4                0           1        1       0           1            1   \n",
       "\n",
       "  trust_nrc  \n",
       "0         2  \n",
       "1         1  \n",
       "2         0  \n",
       "3         0  \n",
       "4         1  \n",
       "\n",
       "[5 rows x 23 columns]"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_eng = pd.concat([df_eng, emo_nrc_eng], axis=1)\n",
    "df_eng.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6c1c4965-667a-45c5-89f7-64aad5a51929",
   "metadata": {},
   "source": [
    "## 2.2 中文语料：NRC情感词典"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "65141d8f-a5cf-4268-80a7-168989b308a8",
   "metadata": {},
   "outputs": [],
   "source": [
    "Positive, Negative, Anger, Anticipation, Disgust, Fear, Joy, Sadness, Surprise, Trust = [], [], [], [], [], [], [], [], [], []\n",
    "\n",
    "for idx, row in nrc.iterrows():\n",
    "    if row['Positive'] == 1:\n",
    "        Positive.append(row['Chnword'])\n",
    "    if row['Negative'] == 1:\n",
    "        Negative.append(row['Chnword'])\n",
    "    if row['Anger'] == 1:\n",
    "        Anger.append(row['Chnword'])\n",
    "    if row['Anticipation'] == 1:\n",
    "        Anticipation.append(row['Chnword'])\n",
    "    if row['Disgust'] == 1:\n",
    "        Disgust.append(row['Chnword'])\n",
    "    if row['Fear'] == 1:\n",
    "        Fear.append(row['Chnword'])\n",
    "    if row['Joy'] == 1:\n",
    "        Joy.append(row['Chnword'])\n",
    "    if row['Sadness'] == 1:\n",
    "        Sadness.append(row['Chnword'])\n",
    "    if row['Surprise'] == 1:\n",
    "        Surprise.append(row['Chnword'])\n",
    "    if row['Trust'] == 1:\n",
    "        Trust.append(row['Chnword'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "2f31add3-c1fb-4204-b0a0-b2f5a4aca34c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>length_nrc</th>\n",
       "      <th>positive_nrc</th>\n",
       "      <th>negative_nrc</th>\n",
       "      <th>anger_nrc</th>\n",
       "      <th>anticipation_nrc</th>\n",
       "      <th>disgust_nrc</th>\n",
       "      <th>fear_nrc</th>\n",
       "      <th>joy_nrc</th>\n",
       "      <th>sadness_nrc</th>\n",
       "      <th>surprise_nrc</th>\n",
       "      <th>trust_nrc</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>30</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>129</td>\n",
       "      <td>7</td>\n",
       "      <td>11</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>11</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>155</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>433</td>\n",
       "      <td>19</td>\n",
       "      <td>14</td>\n",
       "      <td>4</td>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>9</td>\n",
       "      <td>8</td>\n",
       "      <td>4</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  length_nrc positive_nrc negative_nrc anger_nrc anticipation_nrc disgust_nrc  \\\n",
       "0         30            1            2         0                0           0   \n",
       "1        129            7           11         1                0           8   \n",
       "2         11            0            0         0                0           0   \n",
       "3        155            7            7         2                3           4   \n",
       "4        433           19           14         4                9           4   \n",
       "\n",
       "  fear_nrc joy_nrc sadness_nrc surprise_nrc trust_nrc  \n",
       "0        0       0           0            0         1  \n",
       "1        2       0           3            0         4  \n",
       "2        0       0           0            0         0  \n",
       "3        3       2           1            0         4  \n",
       "4        4       9           8            4        13  "
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "emo_nrc_chn = pd.DataFrame(columns=['length_nrc', 'positive_nrc', 'negative_nrc',\n",
    "                                    'anger_nrc', 'anticipation_nrc', 'disgust_nrc', 'fear_nrc',\n",
    "                                    'joy_nrc', 'sadness_nrc', 'surprise_nrc', 'trust_nrc'])\n",
    "\n",
    "for dc in df_chn.index:\n",
    "    positive, negative, anger, anticipation, disgust, fear, joy, sadness, surprise, trust = 0, 0, 0, 0, 0, 0, 0, 0, 0, 0\n",
    "    wordlist = list(jieba.cut(df_chn['广告文本'][dc]))\n",
    "    wordset = set(wordlist)\n",
    "    wordfreq = []\n",
    "    \n",
    "    for word in wordset:\n",
    "        freq = wordlist.count(word)\n",
    "        if word in Positive:\n",
    "            positive += freq\n",
    "        if word in Negative:\n",
    "            negative += freq\n",
    "        if word in Anger:\n",
    "            anger += freq\n",
    "        if word in Anticipation:\n",
    "            anticipation += freq\n",
    "        if word in Disgust:\n",
    "            disgust += freq\n",
    "        if word in Fear:\n",
    "            fear += freq\n",
    "        if word in Joy:\n",
    "            joy += freq\n",
    "        if word in Sadness:\n",
    "            sadness += freq\n",
    "        if word in Surprise:\n",
    "            surprise += freq\n",
    "        if word in Trust:\n",
    "            trust += freq\n",
    "            \n",
    "    emotion_info = {\n",
    "        'length_nrc': len(wordlist),\n",
    "        'positive_nrc': positive,\n",
    "        'negative_nrc': negative,\n",
    "        'anger_nrc': anger,\n",
    "        'anticipation_nrc': anticipation,\n",
    "        'disgust_nrc': disgust,\n",
    "        'fear_nrc': fear,\n",
    "        'joy_nrc': joy,\n",
    "        'sadness_nrc': sadness,\n",
    "        'surprise_nrc': surprise,\n",
    "        'trust_nrc': trust\n",
    "    }\n",
    "    \n",
    "    emo_info = pd.DataFrame([emotion_info])\n",
    "    emo_nrc_chn = pd.concat([emo_nrc_chn, emo_info], ignore_index=True)\n",
    "\n",
    "emo_nrc_chn.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "3e8727a5-f719-4ec8-9f65-5ffd51ddb741",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>index</th>\n",
       "      <th>商品名称</th>\n",
       "      <th>商品类别</th>\n",
       "      <th>出版年</th>\n",
       "      <th>广告文本</th>\n",
       "      <th>广告标题</th>\n",
       "      <th>chn_moral</th>\n",
       "      <th>altr</th>\n",
       "      <th>auth</th>\n",
       "      <th>care</th>\n",
       "      <th>...</th>\n",
       "      <th>positive_nrc</th>\n",
       "      <th>negative_nrc</th>\n",
       "      <th>anger_nrc</th>\n",
       "      <th>anticipation_nrc</th>\n",
       "      <th>disgust_nrc</th>\n",
       "      <th>fear_nrc</th>\n",
       "      <th>joy_nrc</th>\n",
       "      <th>sadness_nrc</th>\n",
       "      <th>surprise_nrc</th>\n",
       "      <th>trust_nrc</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1596</td>\n",
       "      <td>五华牌香烟[May Blossom]</td>\n",
       "      <td>烟草制品</td>\n",
       "      <td>1932</td>\n",
       "      <td>兰勃脱白脱勒公司 五华牌香烟 佛及尼埃香烟  二十枝装每包售国币大洋二角 五十枝装每罐售国币...</td>\n",
       "      <td>五华牌香烟,\"兰勃脱白脱勒公司 五华牌香烟 佛及尼埃香烟\"</td>\n",
       "      <td>None</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>5627</td>\n",
       "      <td>韦廉士红色清导丸[Dr.Willams' Pink Pills For Pale People]</td>\n",
       "      <td>药品</td>\n",
       "      <td>1918</td>\n",
       "      <td>讲求卫生为人生本性天理固然也 人生首贵逐日大便通畅有序为天然所当如此也如若大便不利大肠阻塞则...</td>\n",
       "      <td>韦廉士红色清导丸:'讲求卫生为人生本性天理固然也'</td>\n",
       "      <td>{'altr': 0.0, 'auth': 0.25, 'care': 0.25, 'dil...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>...</td>\n",
       "      <td>7</td>\n",
       "      <td>11</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>13532</td>\n",
       "      <td>大炮台香烟[Three Castles Cigarettes]</td>\n",
       "      <td>烟草制品</td>\n",
       "      <td>1935</td>\n",
       "      <td>香味馥郁,不让名花 另有三炮台出售</td>\n",
       "      <td>大炮台香烟,\"香味馥郁 不让名花\"</td>\n",
       "      <td>None</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1133</td>\n",
       "      <td>婴孩自己药片[Baby's Own]</td>\n",
       "      <td>药品</td>\n",
       "      <td>1930</td>\n",
       "      <td>差肩儿女 秀慧康强 闽有佳音讃羡婴孩自己药片 每年此际小儿患肠胃病者甚多而尤以南方各地天气翳...</td>\n",
       "      <td>婴孩自己药片,\"差肩儿女 秀慧康强 闽有佳音赞美婴孩自己药片\"</td>\n",
       "      <td>{'altr': 0.0, 'auth': 0.2, 'care': 0.2, 'dili'...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>...</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>3146</td>\n",
       "      <td>亚士北罗药片[Aspro]</td>\n",
       "      <td>药品</td>\n",
       "      <td>1933</td>\n",
       "      <td>何以亚士北罗是妇女们的腻友？各国妇女力证亚士北罗药片是她们最需要的药物！为什么？她们的经验知...</td>\n",
       "      <td>亚士北罗药片,\"妇女之腻友\"</td>\n",
       "      <td>{'altr': 0.0, 'auth': 0.16666666666666666, 'ca...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.166667</td>\n",
       "      <td>0.166667</td>\n",
       "      <td>...</td>\n",
       "      <td>19</td>\n",
       "      <td>14</td>\n",
       "      <td>4</td>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>9</td>\n",
       "      <td>8</td>\n",
       "      <td>4</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 30 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   index                                              商品名称  商品类别   出版年  \\\n",
       "0   1596                                五华牌香烟[May Blossom]  烟草制品  1932   \n",
       "1   5627  韦廉士红色清导丸[Dr.Willams' Pink Pills For Pale People]    药品  1918   \n",
       "2  13532                   大炮台香烟[Three Castles Cigarettes]  烟草制品  1935   \n",
       "3   1133                                婴孩自己药片[Baby's Own]    药品  1930   \n",
       "4   3146                                     亚士北罗药片[Aspro]    药品  1933   \n",
       "\n",
       "                                                广告文本  \\\n",
       "0  兰勃脱白脱勒公司 五华牌香烟 佛及尼埃香烟  二十枝装每包售国币大洋二角 五十枝装每罐售国币...   \n",
       "1  讲求卫生为人生本性天理固然也 人生首贵逐日大便通畅有序为天然所当如此也如若大便不利大肠阻塞则...   \n",
       "2                                  香味馥郁,不让名花 另有三炮台出售   \n",
       "3  差肩儿女 秀慧康强 闽有佳音讃羡婴孩自己药片 每年此际小儿患肠胃病者甚多而尤以南方各地天气翳...   \n",
       "4  何以亚士北罗是妇女们的腻友？各国妇女力证亚士北罗药片是她们最需要的药物！为什么？她们的经验知...   \n",
       "\n",
       "                              广告标题  \\\n",
       "0    五华牌香烟,\"兰勃脱白脱勒公司 五华牌香烟 佛及尼埃香烟\"   \n",
       "1        韦廉士红色清导丸:'讲求卫生为人生本性天理固然也'   \n",
       "2                大炮台香烟,\"香味馥郁 不让名花\"   \n",
       "3  婴孩自己药片,\"差肩儿女 秀慧康强 闽有佳音赞美婴孩自己药片\"   \n",
       "4                   亚士北罗药片,\"妇女之腻友\"   \n",
       "\n",
       "                                           chn_moral  altr      auth  \\\n",
       "0                                               None   NaN       NaN   \n",
       "1  {'altr': 0.0, 'auth': 0.25, 'care': 0.25, 'dil...   0.0  0.250000   \n",
       "2                                               None   NaN       NaN   \n",
       "3  {'altr': 0.0, 'auth': 0.2, 'care': 0.2, 'dili'...   0.0  0.200000   \n",
       "4  {'altr': 0.0, 'auth': 0.16666666666666666, 'ca...   0.0  0.166667   \n",
       "\n",
       "       care  ...  positive_nrc  negative_nrc  anger_nrc  anticipation_nrc  \\\n",
       "0       NaN  ...             1             2          0                 0   \n",
       "1  0.250000  ...             7            11          1                 0   \n",
       "2       NaN  ...             0             0          0                 0   \n",
       "3  0.200000  ...             7             7          2                 3   \n",
       "4  0.166667  ...            19            14          4                 9   \n",
       "\n",
       "   disgust_nrc  fear_nrc  joy_nrc  sadness_nrc  surprise_nrc trust_nrc  \n",
       "0            0         0        0            0             0         1  \n",
       "1            8         2        0            3             0         4  \n",
       "2            0         0        0            0             0         0  \n",
       "3            4         3        2            1             0         4  \n",
       "4            4         4        9            8             4        13  \n",
       "\n",
       "[5 rows x 30 columns]"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_chn = pd.concat([df_chn, emo_nrc_chn], axis=1)\n",
    "df_chn.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8a3b29af-81f2-4ec5-88b4-a61dddd19594",
   "metadata": {},
   "source": [
    "## 2.3 中文语料：大连理工情感词典"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f71b88af-b418-40b5-a177-84f61a81a33e",
   "metadata": {},
   "source": [
    "大连理工情感词典是目前中国研究比较成熟的词典之一，它是大连理工大学信息检索研究室在 林鸿飞教授 的指导下经过全体 教研室成员的努力整理和标注的一个中文本体资源。该资源从不同角度描述一个中文词汇或 者短语，包括词语词性种类、情感类别、情感强度及极性等信息。中文情感词汇本体的情感分类体系是在国外比较有影响的Ekman的6大类情感分类体系的基础上构建的。词汇本体加入情感类别“好”对褒义情感进行了更细致的划分。最终词汇本体中的情感共分为7大类21小类。构造该资源的宗旨是在情感计算领域，为中文文本情感分析和倾向性分析提供一个便捷可靠的辅助手段。中文情感词汇本体可以用于解决多类别情感分类的问题，同时也可以用于解决一般的倾向性分析的问题。如下图所示，该词典共包括27466个词语，包含词语、词性种类、词义数、词义序号、情感分类、强度、极性、辅助情感分类、强度和极性。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "bed27325-24e0-4e6b-9792-9f4d4adf7968",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>词语</th>\n",
       "      <th>词性种类</th>\n",
       "      <th>情感分类</th>\n",
       "      <th>强度</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>脏乱</td>\n",
       "      <td>adj</td>\n",
       "      <td>NN</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>糟报</td>\n",
       "      <td>adj</td>\n",
       "      <td>NN</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>早衰</td>\n",
       "      <td>adj</td>\n",
       "      <td>NE</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>责备</td>\n",
       "      <td>verb</td>\n",
       "      <td>NN</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>贼眼</td>\n",
       "      <td>noun</td>\n",
       "      <td>NN</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   词语  词性种类 情感分类  强度\n",
       "0  脏乱   adj   NN   7\n",
       "1  糟报   adj   NN   5\n",
       "2  早衰   adj   NE   5\n",
       "3  责备  verb   NN   5\n",
       "4  贼眼  noun   NN   5"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dlut = pd.read_excel('DLUT-Emotion-Lexicon.xlsx', usecols=['词语', '词性种类', '情感分类', '强度'])\n",
    "dlut.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "1265a051-4694-4b4b-8af0-1dfb868fc7e5",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 整理情感词典\n",
    "Happy, Good, Surprise, Anger, Sad, Fear, Disgust  = [], [], [], [], [], [], []\n",
    "\n",
    "for idx, row in dlut.iterrows():\n",
    "    if row['情感分类'] in ['PA', 'PE']:\n",
    "        Happy.append(row['词语'])\n",
    "    if row['情感分类'] in ['PD', 'PH', 'PG', 'PB', 'PK']:\n",
    "        Good.append(row['词语']) \n",
    "    if row['情感分类'] in ['PC']:\n",
    "        Surprise.append(row['词语'])     \n",
    "    if row['情感分类'] in ['NA']:\n",
    "        Anger.append(row['词语'])    \n",
    "    if row['情感分类'] in ['NB', 'NJ', 'NH', 'PF']:\n",
    "        Sad.append(row['词语'])\n",
    "    if row['情感分类'] in ['NI', 'NC', 'NG']:\n",
    "        Fear.append(row['词语'])\n",
    "    if row['情感分类'] in ['NE', 'ND', 'NN', 'NK', 'NL']:\n",
    "        Disgust.append(row['词语'])\n",
    "Positive = Happy + Good + Surprise\n",
    "Negative = Anger + Sad + Fear + Disgust"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "1ba2bfda-305f-452b-be77-5d880baf312a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>length_dlut</th>\n",
       "      <th>positive_dlut</th>\n",
       "      <th>negative_dlut</th>\n",
       "      <th>anger_dlut</th>\n",
       "      <th>disgust_dlut</th>\n",
       "      <th>fear_dlut</th>\n",
       "      <th>good_dlut</th>\n",
       "      <th>sadness_dlut</th>\n",
       "      <th>surprise_dlut</th>\n",
       "      <th>happy_dlut</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>30</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>129</td>\n",
       "      <td>9</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>11</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>155</td>\n",
       "      <td>7</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>433</td>\n",
       "      <td>34</td>\n",
       "      <td>16</td>\n",
       "      <td>0</td>\n",
       "      <td>14</td>\n",
       "      <td>1</td>\n",
       "      <td>23</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  length_dlut positive_dlut negative_dlut anger_dlut disgust_dlut fear_dlut  \\\n",
       "0          30             0             0          0            0         0   \n",
       "1         129             9             6          0            3         2   \n",
       "2          11             0             0          0            0         0   \n",
       "3         155             7             6          0            5         0   \n",
       "4         433            34            16          0           14         1   \n",
       "\n",
       "  good_dlut sadness_dlut surprise_dlut happy_dlut  \n",
       "0         0            0             0          0  \n",
       "1         9            1             0          0  \n",
       "2         0            0             0          0  \n",
       "3         7            1             0          0  \n",
       "4        23            1             0         11  "
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "emo_dlut = pd.DataFrame(columns=['length_dlut', 'positive_dlut', 'negative_dlut',\n",
    "                                'anger_dlut', 'disgust_dlut', 'fear_dlut', 'good_dlut',\n",
    "                                'sadness_dlut', 'surprise_dlut', 'happy_dlut'])\n",
    "\n",
    "for dc in df_chn.index:\n",
    "    positive, negative, anger, disgust, fear, sad, surprise, good, happy = 0, 0, 0, 0, 0, 0, 0, 0, 0\n",
    "    wordlist = list(jieba.cut(df_chn['广告文本'][dc]))\n",
    "    wordset = set(wordlist)\n",
    "    wordfreq = []\n",
    "    for word in wordset:\n",
    "        freq = wordlist.count(word)\n",
    "        if word in Positive:\n",
    "            positive += freq\n",
    "        if word in Negative:\n",
    "            negative += freq\n",
    "        if word in Anger:\n",
    "            anger += freq\n",
    "        if word in Disgust:\n",
    "            disgust += freq\n",
    "        if word in Fear:\n",
    "            fear += freq\n",
    "        if word in Sad:\n",
    "            sad += freq\n",
    "        if word in Surprise:\n",
    "            surprise += freq\n",
    "        if word in Good:\n",
    "            good += freq\n",
    "        if word in Happy:\n",
    "            happy += freq\n",
    "            \n",
    "    emotion_info = {\n",
    "        'length_dlut': len(wordlist),\n",
    "        'positive_dlut': positive,\n",
    "        'negative_dlut': negative,\n",
    "        'anger_dlut': anger,\n",
    "        'disgust_dlut': disgust,\n",
    "        'fear_dlut': fear,\n",
    "        'good_dlut': good,\n",
    "        'sadness_dlut': sad,\n",
    "        'surprise_dlut': surprise,\n",
    "        'happy_dlut': happy\n",
    "    }\n",
    "    \n",
    "    emo_info = pd.DataFrame([emotion_info])\n",
    "    emo_dlut = pd.concat([emo_dlut, emo_info], ignore_index=True)\n",
    "    \n",
    "emo_dlut.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "2550298a-e6ba-445a-adbd-2b4ef3ec0fd2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>index</th>\n",
       "      <th>商品名称</th>\n",
       "      <th>商品类别</th>\n",
       "      <th>出版年</th>\n",
       "      <th>广告文本</th>\n",
       "      <th>广告标题</th>\n",
       "      <th>chn_moral</th>\n",
       "      <th>altr</th>\n",
       "      <th>auth</th>\n",
       "      <th>care</th>\n",
       "      <th>...</th>\n",
       "      <th>length_dlut</th>\n",
       "      <th>positive_dlut</th>\n",
       "      <th>negative_dlut</th>\n",
       "      <th>anger_dlut</th>\n",
       "      <th>disgust_dlut</th>\n",
       "      <th>fear_dlut</th>\n",
       "      <th>good_dlut</th>\n",
       "      <th>sadness_dlut</th>\n",
       "      <th>surprise_dlut</th>\n",
       "      <th>happy_dlut</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1596</td>\n",
       "      <td>五华牌香烟[May Blossom]</td>\n",
       "      <td>烟草制品</td>\n",
       "      <td>1932</td>\n",
       "      <td>兰勃脱白脱勒公司 五华牌香烟 佛及尼埃香烟  二十枝装每包售国币大洋二角 五十枝装每罐售国币...</td>\n",
       "      <td>五华牌香烟,\"兰勃脱白脱勒公司 五华牌香烟 佛及尼埃香烟\"</td>\n",
       "      <td>None</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>30</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>5627</td>\n",
       "      <td>韦廉士红色清导丸[Dr.Willams' Pink Pills For Pale People]</td>\n",
       "      <td>药品</td>\n",
       "      <td>1918</td>\n",
       "      <td>讲求卫生为人生本性天理固然也 人生首贵逐日大便通畅有序为天然所当如此也如若大便不利大肠阻塞则...</td>\n",
       "      <td>韦廉士红色清导丸:'讲求卫生为人生本性天理固然也'</td>\n",
       "      <td>{'altr': 0.0, 'auth': 0.25, 'care': 0.25, 'dil...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>...</td>\n",
       "      <td>129</td>\n",
       "      <td>9</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>13532</td>\n",
       "      <td>大炮台香烟[Three Castles Cigarettes]</td>\n",
       "      <td>烟草制品</td>\n",
       "      <td>1935</td>\n",
       "      <td>香味馥郁,不让名花 另有三炮台出售</td>\n",
       "      <td>大炮台香烟,\"香味馥郁 不让名花\"</td>\n",
       "      <td>None</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>11</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1133</td>\n",
       "      <td>婴孩自己药片[Baby's Own]</td>\n",
       "      <td>药品</td>\n",
       "      <td>1930</td>\n",
       "      <td>差肩儿女 秀慧康强 闽有佳音讃羡婴孩自己药片 每年此际小儿患肠胃病者甚多而尤以南方各地天气翳...</td>\n",
       "      <td>婴孩自己药片,\"差肩儿女 秀慧康强 闽有佳音赞美婴孩自己药片\"</td>\n",
       "      <td>{'altr': 0.0, 'auth': 0.2, 'care': 0.2, 'dili'...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>...</td>\n",
       "      <td>155</td>\n",
       "      <td>7</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>3146</td>\n",
       "      <td>亚士北罗药片[Aspro]</td>\n",
       "      <td>药品</td>\n",
       "      <td>1933</td>\n",
       "      <td>何以亚士北罗是妇女们的腻友？各国妇女力证亚士北罗药片是她们最需要的药物！为什么？她们的经验知...</td>\n",
       "      <td>亚士北罗药片,\"妇女之腻友\"</td>\n",
       "      <td>{'altr': 0.0, 'auth': 0.16666666666666666, 'ca...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.166667</td>\n",
       "      <td>0.166667</td>\n",
       "      <td>...</td>\n",
       "      <td>433</td>\n",
       "      <td>34</td>\n",
       "      <td>16</td>\n",
       "      <td>0</td>\n",
       "      <td>14</td>\n",
       "      <td>1</td>\n",
       "      <td>23</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 40 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   index                                              商品名称  商品类别   出版年  \\\n",
       "0   1596                                五华牌香烟[May Blossom]  烟草制品  1932   \n",
       "1   5627  韦廉士红色清导丸[Dr.Willams' Pink Pills For Pale People]    药品  1918   \n",
       "2  13532                   大炮台香烟[Three Castles Cigarettes]  烟草制品  1935   \n",
       "3   1133                                婴孩自己药片[Baby's Own]    药品  1930   \n",
       "4   3146                                     亚士北罗药片[Aspro]    药品  1933   \n",
       "\n",
       "                                                广告文本  \\\n",
       "0  兰勃脱白脱勒公司 五华牌香烟 佛及尼埃香烟  二十枝装每包售国币大洋二角 五十枝装每罐售国币...   \n",
       "1  讲求卫生为人生本性天理固然也 人生首贵逐日大便通畅有序为天然所当如此也如若大便不利大肠阻塞则...   \n",
       "2                                  香味馥郁,不让名花 另有三炮台出售   \n",
       "3  差肩儿女 秀慧康强 闽有佳音讃羡婴孩自己药片 每年此际小儿患肠胃病者甚多而尤以南方各地天气翳...   \n",
       "4  何以亚士北罗是妇女们的腻友？各国妇女力证亚士北罗药片是她们最需要的药物！为什么？她们的经验知...   \n",
       "\n",
       "                              广告标题  \\\n",
       "0    五华牌香烟,\"兰勃脱白脱勒公司 五华牌香烟 佛及尼埃香烟\"   \n",
       "1        韦廉士红色清导丸:'讲求卫生为人生本性天理固然也'   \n",
       "2                大炮台香烟,\"香味馥郁 不让名花\"   \n",
       "3  婴孩自己药片,\"差肩儿女 秀慧康强 闽有佳音赞美婴孩自己药片\"   \n",
       "4                   亚士北罗药片,\"妇女之腻友\"   \n",
       "\n",
       "                                           chn_moral  altr      auth  \\\n",
       "0                                               None   NaN       NaN   \n",
       "1  {'altr': 0.0, 'auth': 0.25, 'care': 0.25, 'dil...   0.0  0.250000   \n",
       "2                                               None   NaN       NaN   \n",
       "3  {'altr': 0.0, 'auth': 0.2, 'care': 0.2, 'dili'...   0.0  0.200000   \n",
       "4  {'altr': 0.0, 'auth': 0.16666666666666666, 'ca...   0.0  0.166667   \n",
       "\n",
       "       care  ...  length_dlut  positive_dlut  negative_dlut  anger_dlut  \\\n",
       "0       NaN  ...           30              0              0           0   \n",
       "1  0.250000  ...          129              9              6           0   \n",
       "2       NaN  ...           11              0              0           0   \n",
       "3  0.200000  ...          155              7              6           0   \n",
       "4  0.166667  ...          433             34             16           0   \n",
       "\n",
       "   disgust_dlut  fear_dlut  good_dlut  sadness_dlut  surprise_dlut happy_dlut  \n",
       "0             0          0          0             0              0          0  \n",
       "1             3          2          9             1              0          0  \n",
       "2             0          0          0             0              0          0  \n",
       "3             5          0          7             1              0          0  \n",
       "4            14          1         23             1              0         11  \n",
       "\n",
       "[5 rows x 40 columns]"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_chn = pd.concat([df_chn, emo_dlut], axis=1)\n",
    "df_chn.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "dd80bd69-9cdb-4a4e-999e-33b5a435048a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['index', '商品名称', '商品类别', '出版年', '广告文本', '广告标题', 'chn_moral', 'altr',\n",
       "       'auth', 'care', 'dili', 'fair', 'general', 'libe', 'loya', 'mode',\n",
       "       'resi', 'sanc', 'wast', 'length_nrc', 'positive_nrc', 'negative_nrc',\n",
       "       'anger_nrc', 'anticipation_nrc', 'disgust_nrc', 'fear_nrc', 'joy_nrc',\n",
       "       'sadness_nrc', 'surprise_nrc', 'trust_nrc', 'length_dlut',\n",
       "       'positive_dlut', 'negative_dlut', 'anger_dlut', 'disgust_dlut',\n",
       "       'fear_dlut', 'good_dlut', 'sadness_dlut', 'surprise_dlut',\n",
       "       'happy_dlut'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_chn.columns"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "178ea357-3420-4821-b262-4d4ae5c042fa",
   "metadata": {},
   "source": [
    "# 3.【实战】基于大连理工情感词典对恐育微博进行道德/情绪计算"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "cdf77d6d",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_tokophobia = pd.read_excel('/Users/yangmi/Documents/data/hang.xlsx')\n",
    "#去除空值\n",
    "df_tokophobia = df_tokophobia.dropna(subset=[\"标题/微博内容\"])\n",
    "# 删除基于 '标题/微博内容' 列的重复行\n",
    "df_tokophobia = df_tokophobia.drop_duplicates(subset=['标题/微博内容'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "id": "b12bcc61",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>文本</th>\n",
       "      <th>标题/微博内容</th>\n",
       "      <th>名称</th>\n",
       "      <th>from</th>\n",
       "      <th>时间1</th>\n",
       "      <th>时间</th>\n",
       "      <th>喜欢</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...</td>\n",
       "      <td>我真的极度恐婚恐育，源于我爸源于我前男友，还源于朋友身边的一些男性。哪怕今天女性在这个社会上...</td>\n",
       "      <td>月野璐璐子v</td>\n",
       "      <td>2020年05月31日 22:47\\n                        \\n ...</td>\n",
       "      <td>https://weibo.com/5095368064/J4wlQa5k1?refer_f...</td>\n",
       "      <td>2020年05月31日 22:47</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...</td>\n",
       "      <td>从弹幕里学到了个新词-恐育。 ​</td>\n",
       "      <td>ili523</td>\n",
       "      <td>2020年05月31日 22:29\\n                        \\n ...</td>\n",
       "      <td>https://weibo.com/1862534737/J4weC9Eun?refer_f...</td>\n",
       "      <td>2020年05月31日 22:29</td>\n",
       "      <td>赞</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...</td>\n",
       "      <td>可能只有对象是王一博才能治好我的恐婚恐育...这个预告看的我头都大了，王一博，拜托你跟我成家...</td>\n",
       "      <td>啵宝永不言败</td>\n",
       "      <td>2020年05月31日 22:22\\n                        \\n ...</td>\n",
       "      <td>https://weibo.com/7374180203/J4wbz5A5k?refer_f...</td>\n",
       "      <td>2020年05月31日 22:22</td>\n",
       "      <td>赞</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 no帕布乐木iiio \\n             ...</td>\n",
       "      <td>今天也是十级恐婚和一百级恐育的一天 ​</td>\n",
       "      <td>no帕布乐木iiio</td>\n",
       "      <td>2020年05月31日 22:20\\n                        \\n ...</td>\n",
       "      <td>https://weibo.com/7333355936/J4waZke9b?refer_f...</td>\n",
       "      <td>2020年05月31日 22:20</td>\n",
       "      <td>赞</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 no帕布乐木iiio \\n             ...</td>\n",
       "      <td>一想就停不下来。生孩子，对女性无论是身体，还是职业道路都是巨大的伤害！身体不说了，说说职业道...</td>\n",
       "      <td>我是桃之夭夭_</td>\n",
       "      <td>2020年05月31日 22:09\\n                        \\n ...</td>\n",
       "      <td>https://weibo.com/7409549550/J4w6jaOqf?refer_f...</td>\n",
       "      <td>2020年05月31日 22:09</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                  文本  \\\n",
       "0  c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...   \n",
       "1  c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...   \n",
       "2  c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...   \n",
       "3  c 帮上头条 投诉 收藏 复制微博地址 no帕布乐木iiio \\n             ...   \n",
       "4  c 帮上头条 投诉 收藏 复制微博地址 no帕布乐木iiio \\n             ...   \n",
       "\n",
       "                                             标题/微博内容          名称  \\\n",
       "0  我真的极度恐婚恐育，源于我爸源于我前男友，还源于朋友身边的一些男性。哪怕今天女性在这个社会上...      月野璐璐子v   \n",
       "1                                   从弹幕里学到了个新词-恐育。 ​      ili523   \n",
       "2  可能只有对象是王一博才能治好我的恐婚恐育...这个预告看的我头都大了，王一博，拜托你跟我成家...      啵宝永不言败   \n",
       "3                                今天也是十级恐婚和一百级恐育的一天 ​  no帕布乐木iiio   \n",
       "4  一想就停不下来。生孩子，对女性无论是身体，还是职业道路都是巨大的伤害！身体不说了，说说职业道...     我是桃之夭夭_   \n",
       "\n",
       "                                                from  \\\n",
       "0  2020年05月31日 22:47\\n                        \\n ...   \n",
       "1  2020年05月31日 22:29\\n                        \\n ...   \n",
       "2  2020年05月31日 22:22\\n                        \\n ...   \n",
       "3  2020年05月31日 22:20\\n                        \\n ...   \n",
       "4  2020年05月31日 22:09\\n                        \\n ...   \n",
       "\n",
       "                                                 时间1                 时间 喜欢  \n",
       "0  https://weibo.com/5095368064/J4wlQa5k1?refer_f...  2020年05月31日 22:47  2  \n",
       "1  https://weibo.com/1862534737/J4weC9Eun?refer_f...  2020年05月31日 22:29  赞  \n",
       "2  https://weibo.com/7374180203/J4wbz5A5k?refer_f...  2020年05月31日 22:22  赞  \n",
       "3  https://weibo.com/7333355936/J4waZke9b?refer_f...  2020年05月31日 22:20  赞  \n",
       "4  https://weibo.com/7409549550/J4w6jaOqf?refer_f...  2020年05月31日 22:09  2  "
      ]
     },
     "execution_count": 55,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_tokophobia.drop(df_tokophobia.columns[2:4], axis=1, inplace=True)\n",
    "df_tokophobia.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "id": "351f2b20-86d5-4eeb-9e46-18ef76a66f96",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>文本</th>\n",
       "      <th>标题/微博内容</th>\n",
       "      <th>名称</th>\n",
       "      <th>时间</th>\n",
       "      <th>喜欢</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...</td>\n",
       "      <td>我真的极度恐婚恐育，源于我爸源于我前男友，还源于朋友身边的一些男性。哪怕今天女性在这个社会上...</td>\n",
       "      <td>月野璐璐子v</td>\n",
       "      <td>2020年05月31日 22:47</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...</td>\n",
       "      <td>从弹幕里学到了个新词-恐育。 ​</td>\n",
       "      <td>ili523</td>\n",
       "      <td>2020年05月31日 22:29</td>\n",
       "      <td>赞</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...</td>\n",
       "      <td>可能只有对象是王一博才能治好我的恐婚恐育...这个预告看的我头都大了，王一博，拜托你跟我成家...</td>\n",
       "      <td>啵宝永不言败</td>\n",
       "      <td>2020年05月31日 22:22</td>\n",
       "      <td>赞</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 no帕布乐木iiio \\n             ...</td>\n",
       "      <td>今天也是十级恐婚和一百级恐育的一天 ​</td>\n",
       "      <td>no帕布乐木iiio</td>\n",
       "      <td>2020年05月31日 22:20</td>\n",
       "      <td>赞</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 no帕布乐木iiio \\n             ...</td>\n",
       "      <td>一想就停不下来。生孩子，对女性无论是身体，还是职业道路都是巨大的伤害！身体不说了，说说职业道...</td>\n",
       "      <td>我是桃之夭夭_</td>\n",
       "      <td>2020年05月31日 22:09</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                  文本  \\\n",
       "0  c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...   \n",
       "1  c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...   \n",
       "2  c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...   \n",
       "3  c 帮上头条 投诉 收藏 复制微博地址 no帕布乐木iiio \\n             ...   \n",
       "4  c 帮上头条 投诉 收藏 复制微博地址 no帕布乐木iiio \\n             ...   \n",
       "\n",
       "                                             标题/微博内容          名称  \\\n",
       "0  我真的极度恐婚恐育，源于我爸源于我前男友，还源于朋友身边的一些男性。哪怕今天女性在这个社会上...      月野璐璐子v   \n",
       "1                                   从弹幕里学到了个新词-恐育。 ​      ili523   \n",
       "2  可能只有对象是王一博才能治好我的恐婚恐育...这个预告看的我头都大了，王一博，拜托你跟我成家...      啵宝永不言败   \n",
       "3                                今天也是十级恐婚和一百级恐育的一天 ​  no帕布乐木iiio   \n",
       "4  一想就停不下来。生孩子，对女性无论是身体，还是职业道路都是巨大的伤害！身体不说了，说说职业道...     我是桃之夭夭_   \n",
       "\n",
       "                  时间 喜欢  \n",
       "0  2020年05月31日 22:47  2  \n",
       "1  2020年05月31日 22:29  赞  \n",
       "2  2020年05月31日 22:22  赞  \n",
       "3  2020年05月31日 22:20  赞  \n",
       "4  2020年05月31日 22:09  2  "
      ]
     },
     "execution_count": 56,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_tokophobia.drop(df_tokophobia.columns[3:5], axis=1, inplace=True)\n",
    "df_tokophobia.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7bb11fcd",
   "metadata": {},
   "source": [
    "## 3.1 基于cmfd词典的道德计算"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "f77e878c",
   "metadata": {},
   "outputs": [],
   "source": [
    "chn_moral = pd.read_csv(r'https://raw.githubusercontent.com/CivicTechLab/CMFD/main/cmfd_civictech.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "9b402b6a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>chinese</th>\n",
       "      <th>foundation</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>同情</td>\n",
       "      <td>care</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>一臂之力</td>\n",
       "      <td>care</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>一见倾心</td>\n",
       "      <td>care</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>三个代表</td>\n",
       "      <td>care</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>上阵杀敌</td>\n",
       "      <td>care</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6133</th>\n",
       "      <td>随和</td>\n",
       "      <td>general</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6134</th>\n",
       "      <td>雅正</td>\n",
       "      <td>general</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6135</th>\n",
       "      <td>雷打不动</td>\n",
       "      <td>general</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6136</th>\n",
       "      <td>马马虎虎</td>\n",
       "      <td>general</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6137</th>\n",
       "      <td>骨节</td>\n",
       "      <td>general</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>6138 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     chinese foundation\n",
       "0         同情       care\n",
       "1       一臂之力       care\n",
       "2       一见倾心       care\n",
       "3       三个代表       care\n",
       "4       上阵杀敌       care\n",
       "...      ...        ...\n",
       "6133      随和    general\n",
       "6134      雅正    general\n",
       "6135    雷打不动    general\n",
       "6136    马马虎虎    general\n",
       "6137      骨节    general\n",
       "\n",
       "[6138 rows x 2 columns]"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "chn_moral"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "5735de42",
   "metadata": {},
   "outputs": [],
   "source": [
    "moral_dict = chn_moral.groupby('foundation')['chinese'].apply(list).to_dict()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "da4c0552",
   "metadata": {},
   "outputs": [],
   "source": [
    "def moral_quantity(text):\n",
    "    \n",
    "    if isinstance(text, str):\n",
    "        moral_word_total = 0\n",
    "        moral_word = {}\n",
    "        moral_num = {}\n",
    "\n",
    "        for key in moral_dict.keys():\n",
    "            moral_word[key] = []\n",
    "        for word in jieba.cut(text):\n",
    "            for key in moral_dict.keys():\n",
    "                if word in moral_dict[key]:\n",
    "                    moral_word[key].append(word)\n",
    "\n",
    "        for key in moral_word.keys():\n",
    "            moral_word_total += len(moral_word[key])\n",
    "        if moral_word_total == 0:\n",
    "            return None\n",
    "\n",
    "        for key in moral_word.keys():\n",
    "            moral_num[key] = len(moral_word[key]) / moral_word_total\n",
    "\n",
    "    return moral_num"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "id": "953f7b85",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>文本</th>\n",
       "      <th>标题/微博内容</th>\n",
       "      <th>名称</th>\n",
       "      <th>时间</th>\n",
       "      <th>喜欢</th>\n",
       "      <th>chn_moral</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...</td>\n",
       "      <td>我真的极度恐婚恐育，源于我爸源于我前男友，还源于朋友身边的一些男性。哪怕今天女性在这个社会上...</td>\n",
       "      <td>月野璐璐子v</td>\n",
       "      <td>2020年05月31日 22:47</td>\n",
       "      <td>2</td>\n",
       "      <td>{'altr': 0.0, 'auth': 0.5, 'care': 0.0, 'dili'...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...</td>\n",
       "      <td>从弹幕里学到了个新词-恐育。 ​</td>\n",
       "      <td>ili523</td>\n",
       "      <td>2020年05月31日 22:29</td>\n",
       "      <td>赞</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...</td>\n",
       "      <td>可能只有对象是王一博才能治好我的恐婚恐育...这个预告看的我头都大了，王一博，拜托你跟我成家...</td>\n",
       "      <td>啵宝永不言败</td>\n",
       "      <td>2020年05月31日 22:22</td>\n",
       "      <td>赞</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 no帕布乐木iiio \\n             ...</td>\n",
       "      <td>今天也是十级恐婚和一百级恐育的一天 ​</td>\n",
       "      <td>no帕布乐木iiio</td>\n",
       "      <td>2020年05月31日 22:20</td>\n",
       "      <td>赞</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 no帕布乐木iiio \\n             ...</td>\n",
       "      <td>一想就停不下来。生孩子，对女性无论是身体，还是职业道路都是巨大的伤害！身体不说了，说说职业道...</td>\n",
       "      <td>我是桃之夭夭_</td>\n",
       "      <td>2020年05月31日 22:09</td>\n",
       "      <td>2</td>\n",
       "      <td>{'altr': 0.0, 'auth': 0.0, 'care': 0.5, 'dili'...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                  文本  \\\n",
       "0  c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...   \n",
       "1  c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...   \n",
       "2  c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...   \n",
       "3  c 帮上头条 投诉 收藏 复制微博地址 no帕布乐木iiio \\n             ...   \n",
       "4  c 帮上头条 投诉 收藏 复制微博地址 no帕布乐木iiio \\n             ...   \n",
       "\n",
       "                                             标题/微博内容          名称  \\\n",
       "0  我真的极度恐婚恐育，源于我爸源于我前男友，还源于朋友身边的一些男性。哪怕今天女性在这个社会上...      月野璐璐子v   \n",
       "1                                   从弹幕里学到了个新词-恐育。 ​      ili523   \n",
       "2  可能只有对象是王一博才能治好我的恐婚恐育...这个预告看的我头都大了，王一博，拜托你跟我成家...      啵宝永不言败   \n",
       "3                                今天也是十级恐婚和一百级恐育的一天 ​  no帕布乐木iiio   \n",
       "4  一想就停不下来。生孩子，对女性无论是身体，还是职业道路都是巨大的伤害！身体不说了，说说职业道...     我是桃之夭夭_   \n",
       "\n",
       "                  时间 喜欢                                          chn_moral  \n",
       "0  2020年05月31日 22:47  2  {'altr': 0.0, 'auth': 0.5, 'care': 0.0, 'dili'...  \n",
       "1  2020年05月31日 22:29  赞                                               None  \n",
       "2  2020年05月31日 22:22  赞                                               None  \n",
       "3  2020年05月31日 22:20  赞                                               None  \n",
       "4  2020年05月31日 22:09  2  {'altr': 0.0, 'auth': 0.0, 'care': 0.5, 'dili'...  "
      ]
     },
     "execution_count": 57,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_tokophobia['chn_moral'] = df_tokophobia['标题/微博内容'].apply(moral_quantity)\n",
    "df_tokophobia.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "id": "0b003f20-cc49-4f5b-a775-606c9c37d5e3",
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "# 定义一个函数来拆分字典\n",
    "def split_moral(moral):\n",
    "    if moral is None:\n",
    "        return pd.Series([None] * 12, index=['altr', 'auth', 'care', 'dili', 'fair', 'general', 'libe', 'loya', 'mode', 'resi', 'sanc', 'wast'])\n",
    "    else:\n",
    "        return pd.Series(moral)\n",
    "\n",
    "# 应用函数到 moral 列\n",
    "moral_df = df_tokophobia['chn_moral'].apply(split_moral)\n",
    "df_tokophobia = df_tokophobia.drop('chn_moral', axis=1).join(moral_df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "id": "828c092d-e6aa-473a-ac26-7a1170c6bbd7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>文本</th>\n",
       "      <th>标题/微博内容</th>\n",
       "      <th>名称</th>\n",
       "      <th>时间</th>\n",
       "      <th>喜欢</th>\n",
       "      <th>altr</th>\n",
       "      <th>auth</th>\n",
       "      <th>care</th>\n",
       "      <th>dili</th>\n",
       "      <th>fair</th>\n",
       "      <th>general</th>\n",
       "      <th>libe</th>\n",
       "      <th>loya</th>\n",
       "      <th>mode</th>\n",
       "      <th>resi</th>\n",
       "      <th>sanc</th>\n",
       "      <th>wast</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...</td>\n",
       "      <td>我真的极度恐婚恐育，源于我爸源于我前男友，还源于朋友身边的一些男性。哪怕今天女性在这个社会上...</td>\n",
       "      <td>月野璐璐子v</td>\n",
       "      <td>2020年05月31日 22:47</td>\n",
       "      <td>2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...</td>\n",
       "      <td>从弹幕里学到了个新词-恐育。 ​</td>\n",
       "      <td>ili523</td>\n",
       "      <td>2020年05月31日 22:29</td>\n",
       "      <td>赞</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...</td>\n",
       "      <td>可能只有对象是王一博才能治好我的恐婚恐育...这个预告看的我头都大了，王一博，拜托你跟我成家...</td>\n",
       "      <td>啵宝永不言败</td>\n",
       "      <td>2020年05月31日 22:22</td>\n",
       "      <td>赞</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 no帕布乐木iiio \\n             ...</td>\n",
       "      <td>今天也是十级恐婚和一百级恐育的一天 ​</td>\n",
       "      <td>no帕布乐木iiio</td>\n",
       "      <td>2020年05月31日 22:20</td>\n",
       "      <td>赞</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 no帕布乐木iiio \\n             ...</td>\n",
       "      <td>一想就停不下来。生孩子，对女性无论是身体，还是职业道路都是巨大的伤害！身体不说了，说说职业道...</td>\n",
       "      <td>我是桃之夭夭_</td>\n",
       "      <td>2020年05月31日 22:09</td>\n",
       "      <td>2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42281</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 阿尔托利斯不相信眼泪 \\n             ...</td>\n",
       "      <td>艹 虽然我连对象也没有而且恐婚恐育但是我却已经看好了婚戒 ​</td>\n",
       "      <td>做题家也真的卷不动辣</td>\n",
       "      <td>2021年12月29日 16:45</td>\n",
       "      <td>赞</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42282</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 阿尔托利斯不相信眼泪 \\n             ...</td>\n",
       "      <td>打一顿就好//@专家醒提您请不要弃治放疗 :妈妈说的这些话应该裱起来//@可可布朗尼猪宝 :...</td>\n",
       "      <td>麦芽玛雅</td>\n",
       "      <td>2021年12月29日 16:45</td>\n",
       "      <td>8524</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42283</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 ZaLawoo \\n                ...</td>\n",
       "      <td>踏马的//@京城第一母老虎 :恐育值又⬆️了</td>\n",
       "      <td>只能次鸡腿儿</td>\n",
       "      <td>2021年12月31日 22:27</td>\n",
       "      <td>186264</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42285</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 那个小富贵儿 \\n                 ...</td>\n",
       "      <td>看的我要心梗了//@京城第一母老虎:恐育值又⬆️了</td>\n",
       "      <td>爱甜甜的木木小七</td>\n",
       "      <td>2021年12月31日 22:23</td>\n",
       "      <td>186264</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42286</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 那个小富贵儿 \\n                 ...</td>\n",
       "      <td>#2021# 要说今年最深刻的感想，就是角色的转变了，我的身份🏷️增加了「母亲」标签，想起好...</td>\n",
       "      <td>竹均子欧尼</td>\n",
       "      <td>2021年12月31日 22:21</td>\n",
       "      <td>9</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>35526 rows × 17 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                      文本  \\\n",
       "0      c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...   \n",
       "1      c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...   \n",
       "2      c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...   \n",
       "3      c 帮上头条 投诉 收藏 复制微博地址 no帕布乐木iiio \\n             ...   \n",
       "4      c 帮上头条 投诉 收藏 复制微博地址 no帕布乐木iiio \\n             ...   \n",
       "...                                                  ...   \n",
       "42281  c 帮上头条 投诉 收藏 复制微博地址 阿尔托利斯不相信眼泪 \\n             ...   \n",
       "42282  c 帮上头条 投诉 收藏 复制微博地址 阿尔托利斯不相信眼泪 \\n             ...   \n",
       "42283  c 帮上头条 投诉 收藏 复制微博地址 ZaLawoo \\n                ...   \n",
       "42285  c 帮上头条 投诉 收藏 复制微博地址 那个小富贵儿 \\n                 ...   \n",
       "42286  c 帮上头条 投诉 收藏 复制微博地址 那个小富贵儿 \\n                 ...   \n",
       "\n",
       "                                                 标题/微博内容          名称  \\\n",
       "0      我真的极度恐婚恐育，源于我爸源于我前男友，还源于朋友身边的一些男性。哪怕今天女性在这个社会上...      月野璐璐子v   \n",
       "1                                       从弹幕里学到了个新词-恐育。 ​      ili523   \n",
       "2      可能只有对象是王一博才能治好我的恐婚恐育...这个预告看的我头都大了，王一博，拜托你跟我成家...      啵宝永不言败   \n",
       "3                                    今天也是十级恐婚和一百级恐育的一天 ​  no帕布乐木iiio   \n",
       "4      一想就停不下来。生孩子，对女性无论是身体，还是职业道路都是巨大的伤害！身体不说了，说说职业道...     我是桃之夭夭_   \n",
       "...                                                  ...         ...   \n",
       "42281                     艹 虽然我连对象也没有而且恐婚恐育但是我却已经看好了婚戒 ​  做题家也真的卷不动辣   \n",
       "42282  打一顿就好//@专家醒提您请不要弃治放疗 :妈妈说的这些话应该裱起来//@可可布朗尼猪宝 :...        麦芽玛雅   \n",
       "42283                             踏马的//@京城第一母老虎 :恐育值又⬆️了      只能次鸡腿儿   \n",
       "42285                          看的我要心梗了//@京城第一母老虎:恐育值又⬆️了    爱甜甜的木木小七   \n",
       "42286  #2021# 要说今年最深刻的感想，就是角色的转变了，我的身份🏷️增加了「母亲」标签，想起好...       竹均子欧尼   \n",
       "\n",
       "                      时间      喜欢  altr  auth  care  dili  fair  general  libe  \\\n",
       "0      2020年05月31日 22:47       2   0.0   0.5   0.0   0.0   0.0      0.0   0.0   \n",
       "1      2020年05月31日 22:29       赞   NaN   NaN   NaN   NaN   NaN      NaN   NaN   \n",
       "2      2020年05月31日 22:22       赞   NaN   NaN   NaN   NaN   NaN      NaN   NaN   \n",
       "3      2020年05月31日 22:20       赞   NaN   NaN   NaN   NaN   NaN      NaN   NaN   \n",
       "4      2020年05月31日 22:09       2   0.0   0.0   0.5   0.0   0.0      0.0   0.0   \n",
       "...                  ...     ...   ...   ...   ...   ...   ...      ...   ...   \n",
       "42281  2021年12月29日 16:45       赞   NaN   NaN   NaN   NaN   NaN      NaN   NaN   \n",
       "42282  2021年12月29日 16:45    8524   0.0   1.0   0.0   0.0   0.0      0.0   0.0   \n",
       "42283  2021年12月31日 22:27  186264   NaN   NaN   NaN   NaN   NaN      NaN   NaN   \n",
       "42285  2021年12月31日 22:23  186264   NaN   NaN   NaN   NaN   NaN      NaN   NaN   \n",
       "42286  2021年12月31日 22:21       9   0.0   0.0   0.0   0.0   0.0      0.0   0.0   \n",
       "\n",
       "       loya  mode  resi  sanc  wast  \n",
       "0       0.5   0.0   0.0   0.0   0.0  \n",
       "1       NaN   NaN   NaN   NaN   NaN  \n",
       "2       NaN   NaN   NaN   NaN   NaN  \n",
       "3       NaN   NaN   NaN   NaN   NaN  \n",
       "4       0.5   0.0   0.0   0.0   0.0  \n",
       "...     ...   ...   ...   ...   ...  \n",
       "42281   NaN   NaN   NaN   NaN   NaN  \n",
       "42282   0.0   0.0   0.0   0.0   0.0  \n",
       "42283   NaN   NaN   NaN   NaN   NaN  \n",
       "42285   NaN   NaN   NaN   NaN   NaN  \n",
       "42286   0.5   0.0   0.0   0.5   0.0  \n",
       "\n",
       "[35526 rows x 17 columns]"
      ]
     },
     "execution_count": 59,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_tokophobia"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "id": "72ebf8cb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['index', '商品名称', '商品类别', '出版年', '广告文本', '广告标题', 'chn_moral', 'altr',\n",
       "       'auth', 'care', 'dili', 'fair', 'general', 'libe', 'loya', 'mode',\n",
       "       'resi', 'sanc', 'wast', 'length_nrc', 'positive_nrc', 'negative_nrc',\n",
       "       'anger_nrc', 'anticipation_nrc', 'disgust_nrc', 'fear_nrc', 'joy_nrc',\n",
       "       'sadness_nrc', 'surprise_nrc', 'trust_nrc', 'length_dlut',\n",
       "       'positive_dlut', 'negative_dlut', 'anger_dlut', 'disgust_dlut',\n",
       "       'fear_dlut', 'good_dlut', 'sadness_dlut', 'surprise_dlut',\n",
       "       'happy_dlut'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 60,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_chn.columns"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4123d17a-c6d2-4438-a027-5966e6ae5618",
   "metadata": {},
   "source": [
    "## 3.2 基于NRC词典的情感分析"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "id": "af6ad223-f969-486c-8358-34d8aa2d81af",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/yangmi/anaconda3/lib/python3.11/site-packages/openpyxl/worksheet/_read_only.py:79: UserWarning: Unknown extension is not supported and will be removed\n",
      "  for idx, row in parser.parse():\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Engword</th>\n",
       "      <th>Chnword</th>\n",
       "      <th>Positive</th>\n",
       "      <th>Negative</th>\n",
       "      <th>Anger</th>\n",
       "      <th>Anticipation</th>\n",
       "      <th>Disgust</th>\n",
       "      <th>Fear</th>\n",
       "      <th>Joy</th>\n",
       "      <th>Sadness</th>\n",
       "      <th>Surprise</th>\n",
       "      <th>Trust</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>aback</td>\n",
       "      <td>吓了一跳</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>abacus</td>\n",
       "      <td>算盘</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>abandon</td>\n",
       "      <td>放弃</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>abandoned</td>\n",
       "      <td>弃</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>abandonment</td>\n",
       "      <td>放弃</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       Engword Chnword  Positive  Negative  Anger  Anticipation  Disgust  \\\n",
       "0        aback    吓了一跳         0         0      0             0        0   \n",
       "1       abacus      算盘         0         0      0             0        0   \n",
       "2      abandon      放弃         0         1      0             0        0   \n",
       "3    abandoned       弃         0         1      1             0        0   \n",
       "4  abandonment      放弃         0         1      1             0        0   \n",
       "\n",
       "   Fear  Joy  Sadness  Surprise  Trust  \n",
       "0     0    0        0         0      0  \n",
       "1     0    0        0         0      1  \n",
       "2     1    0        1         0      0  \n",
       "3     1    0        1         0      0  \n",
       "4     1    0        1         1      0  "
      ]
     },
     "execution_count": 61,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nrc = pd.read_excel('NRC-Emotion-Lexicon.xlsx', usecols='A, F, AP:AY')\n",
    "nrc = nrc.rename(columns={'English Word':'Engword', 'Chinese (simplified) Translation (Google Translate)':'Chnword'})\n",
    "nrc.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 88,
   "id": "436b1bca-76f7-4bcd-b99f-2b6f896028df",
   "metadata": {},
   "outputs": [],
   "source": [
    "#导入数据并去除空值\n",
    "tokophobia = pd.read_excel('/Users/yangmi/Documents/data/hang.xlsx')\n",
    "tokophobia = tokophobia.dropna(subset=[\"标题/微博内容\"])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 92,
   "id": "5dfad87b-ac1c-4153-895e-5c919768082c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>标题/微博内容</th>\n",
       "      <th>名称</th>\n",
       "      <th>时间</th>\n",
       "      <th>喜欢</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>我真的极度恐婚恐育，源于我爸源于我前男友，还源于朋友身边的一些男性。哪怕今天女性在这个社会上...</td>\n",
       "      <td>月野璐璐子v</td>\n",
       "      <td>2020年05月31日 22:47</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>从弹幕里学到了个新词-恐育。 ​</td>\n",
       "      <td>ili523</td>\n",
       "      <td>2020年05月31日 22:29</td>\n",
       "      <td>赞</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>可能只有对象是王一博才能治好我的恐婚恐育...这个预告看的我头都大了，王一博，拜托你跟我成家...</td>\n",
       "      <td>啵宝永不言败</td>\n",
       "      <td>2020年05月31日 22:22</td>\n",
       "      <td>赞</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>今天也是十级恐婚和一百级恐育的一天 ​</td>\n",
       "      <td>no帕布乐木iiio</td>\n",
       "      <td>2020年05月31日 22:20</td>\n",
       "      <td>赞</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>一想就停不下来。生孩子，对女性无论是身体，还是职业道路都是巨大的伤害！身体不说了，说说职业道...</td>\n",
       "      <td>我是桃之夭夭_</td>\n",
       "      <td>2020年05月31日 22:09</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                             标题/微博内容          名称  \\\n",
       "0  我真的极度恐婚恐育，源于我爸源于我前男友，还源于朋友身边的一些男性。哪怕今天女性在这个社会上...      月野璐璐子v   \n",
       "1                                   从弹幕里学到了个新词-恐育。 ​      ili523   \n",
       "2  可能只有对象是王一博才能治好我的恐婚恐育...这个预告看的我头都大了，王一博，拜托你跟我成家...      啵宝永不言败   \n",
       "3                                今天也是十级恐婚和一百级恐育的一天 ​  no帕布乐木iiio   \n",
       "4  一想就停不下来。生孩子，对女性无论是身体，还是职业道路都是巨大的伤害！身体不说了，说说职业道...     我是桃之夭夭_   \n",
       "\n",
       "                  时间 喜欢  \n",
       "0  2020年05月31日 22:47  2  \n",
       "1  2020年05月31日 22:29  赞  \n",
       "2  2020年05月31日 22:22  赞  \n",
       "3  2020年05月31日 22:20  赞  \n",
       "4  2020年05月31日 22:09  2  "
      ]
     },
     "execution_count": 92,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#删除基于 '标题/微博内容' 列的重复行、不需要的变量\n",
    "tokophobia = tokophobia.drop_duplicates(subset=['标题/微博内容'])\n",
    "tokophobia.drop(tokophobia.columns[2:4], axis=1, inplace=True)\n",
    "tokophobia.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 93,
   "id": "8ba1fa96-7b6f-4e85-86d0-7274d2d65a3a",
   "metadata": {},
   "outputs": [],
   "source": [
    "Positive, Negative, Anger, Anticipation, Disgust, Fear, Joy, Sadness, Surprise, Trust = [], [], [], [], [], [], [], [], [], []\n",
    "\n",
    "for idx, row in nrc.iterrows():\n",
    "    if row['Positive'] == 1:\n",
    "        Positive.append(row['Chnword'])\n",
    "    if row['Negative'] == 1:\n",
    "        Negative.append(row['Chnword'])\n",
    "    if row['Anger'] == 1:\n",
    "        Anger.append(row['Chnword'])\n",
    "    if row['Anticipation'] == 1:\n",
    "        Anticipation.append(row['Chnword'])\n",
    "    if row['Disgust'] == 1:\n",
    "        Disgust.append(row['Chnword'])\n",
    "    if row['Fear'] == 1:\n",
    "        Fear.append(row['Chnword'])\n",
    "    if row['Joy'] == 1:\n",
    "        Joy.append(row['Chnword'])\n",
    "    if row['Sadness'] == 1:\n",
    "        Sadness.append(row['Chnword'])\n",
    "    if row['Surprise'] == 1:\n",
    "        Surprise.append(row['Chnword'])\n",
    "    if row['Trust'] == 1:\n",
    "        Trust.append(row['Chnword'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 94,
   "id": "754dffc1-4243-40d0-b436-ba0f44feda3b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>length_nrc</th>\n",
       "      <th>positive_nrc</th>\n",
       "      <th>negative_nrc</th>\n",
       "      <th>anger_nrc</th>\n",
       "      <th>anticipation_nrc</th>\n",
       "      <th>disgust_nrc</th>\n",
       "      <th>fear_nrc</th>\n",
       "      <th>joy_nrc</th>\n",
       "      <th>sadness_nrc</th>\n",
       "      <th>surprise_nrc</th>\n",
       "      <th>trust_nrc</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>84</td>\n",
       "      <td>6</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>12</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>33</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>13</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>95</td>\n",
       "      <td>12</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  length_nrc positive_nrc negative_nrc anger_nrc anticipation_nrc disgust_nrc  \\\n",
       "0         84            6            4         1                2           1   \n",
       "1         12            0            0         0                0           0   \n",
       "2         33            0            0         0                1           0   \n",
       "3         13            0            0         0                0           0   \n",
       "4         95           12            5         3                5           1   \n",
       "\n",
       "  fear_nrc joy_nrc sadness_nrc surprise_nrc trust_nrc  \n",
       "0        3       2           4            2         3  \n",
       "1        0       0           0            0         0  \n",
       "2        1       0           0            0         0  \n",
       "3        0       0           0            0         0  \n",
       "4        3       4           4            0         2  "
      ]
     },
     "execution_count": 94,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "emo_nrc_chn = pd.DataFrame(columns=['length_nrc', 'positive_nrc', 'negative_nrc',\n",
    "                                    'anger_nrc', 'anticipation_nrc', 'disgust_nrc', 'fear_nrc',\n",
    "                                    'joy_nrc', 'sadness_nrc', 'surprise_nrc', 'trust_nrc'])\n",
    "\n",
    "for dc in tokophobia.index:\n",
    "    positive, negative, anger, anticipation, disgust, fear, joy, sadness, surprise, trust = 0, 0, 0, 0, 0, 0, 0, 0, 0, 0\n",
    "    wordlist = list(jieba.cut(tokophobia[\"标题/微博内容\"][dc]))\n",
    "    wordset = set(wordlist)\n",
    "    wordfreq = []\n",
    "    \n",
    "    for word in wordset:\n",
    "        freq = wordlist.count(word)\n",
    "        if word in Positive:\n",
    "            positive += freq\n",
    "        if word in Negative:\n",
    "            negative += freq\n",
    "        if word in Anger:\n",
    "            anger += freq\n",
    "        if word in Anticipation:\n",
    "            anticipation += freq\n",
    "        if word in Disgust:\n",
    "            disgust += freq\n",
    "        if word in Fear:\n",
    "            fear += freq\n",
    "        if word in Joy:\n",
    "            joy += freq\n",
    "        if word in Sadness:\n",
    "            sadness += freq\n",
    "        if word in Surprise:\n",
    "            surprise += freq\n",
    "        if word in Trust:\n",
    "            trust += freq\n",
    "            \n",
    "    emotion_info = {\n",
    "        'length_nrc': len(wordlist),\n",
    "        'positive_nrc': positive,\n",
    "        'negative_nrc': negative,\n",
    "        'anger_nrc': anger,\n",
    "        'anticipation_nrc': anticipation,\n",
    "        'disgust_nrc': disgust,\n",
    "        'fear_nrc': fear,\n",
    "        'joy_nrc': joy,\n",
    "        'sadness_nrc': sadness,\n",
    "        'surprise_nrc': surprise,\n",
    "        'trust_nrc': trust\n",
    "    }\n",
    "    \n",
    "    emo_info = pd.DataFrame([emotion_info])\n",
    "    emo_nrc_chn = pd.concat([emo_nrc_chn, emo_info], ignore_index=True)\n",
    "\n",
    "emo_nrc_chn.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 95,
   "id": "b4ee6e7f-277f-46dd-9d43-6b8bfcd98c68",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>标题/微博内容</th>\n",
       "      <th>名称</th>\n",
       "      <th>时间</th>\n",
       "      <th>喜欢</th>\n",
       "      <th>length_nrc</th>\n",
       "      <th>positive_nrc</th>\n",
       "      <th>negative_nrc</th>\n",
       "      <th>anger_nrc</th>\n",
       "      <th>anticipation_nrc</th>\n",
       "      <th>disgust_nrc</th>\n",
       "      <th>fear_nrc</th>\n",
       "      <th>joy_nrc</th>\n",
       "      <th>sadness_nrc</th>\n",
       "      <th>surprise_nrc</th>\n",
       "      <th>trust_nrc</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>我真的极度恐婚恐育，源于我爸源于我前男友，还源于朋友身边的一些男性。哪怕今天女性在这个社会上...</td>\n",
       "      <td>月野璐璐子v</td>\n",
       "      <td>2020年05月31日 22:47</td>\n",
       "      <td>2</td>\n",
       "      <td>84</td>\n",
       "      <td>6</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>从弹幕里学到了个新词-恐育。 ​</td>\n",
       "      <td>ili523</td>\n",
       "      <td>2020年05月31日 22:29</td>\n",
       "      <td>赞</td>\n",
       "      <td>12</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>可能只有对象是王一博才能治好我的恐婚恐育...这个预告看的我头都大了，王一博，拜托你跟我成家...</td>\n",
       "      <td>啵宝永不言败</td>\n",
       "      <td>2020年05月31日 22:22</td>\n",
       "      <td>赞</td>\n",
       "      <td>33</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>今天也是十级恐婚和一百级恐育的一天 ​</td>\n",
       "      <td>no帕布乐木iiio</td>\n",
       "      <td>2020年05月31日 22:20</td>\n",
       "      <td>赞</td>\n",
       "      <td>13</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>一想就停不下来。生孩子，对女性无论是身体，还是职业道路都是巨大的伤害！身体不说了，说说职业道...</td>\n",
       "      <td>我是桃之夭夭_</td>\n",
       "      <td>2020年05月31日 22:09</td>\n",
       "      <td>2</td>\n",
       "      <td>95</td>\n",
       "      <td>12</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                             标题/微博内容          名称  \\\n",
       "0  我真的极度恐婚恐育，源于我爸源于我前男友，还源于朋友身边的一些男性。哪怕今天女性在这个社会上...      月野璐璐子v   \n",
       "1                                   从弹幕里学到了个新词-恐育。 ​      ili523   \n",
       "2  可能只有对象是王一博才能治好我的恐婚恐育...这个预告看的我头都大了，王一博，拜托你跟我成家...      啵宝永不言败   \n",
       "3                                今天也是十级恐婚和一百级恐育的一天 ​  no帕布乐木iiio   \n",
       "4  一想就停不下来。生孩子，对女性无论是身体，还是职业道路都是巨大的伤害！身体不说了，说说职业道...     我是桃之夭夭_   \n",
       "\n",
       "                  时间 喜欢 length_nrc positive_nrc negative_nrc anger_nrc  \\\n",
       "0  2020年05月31日 22:47  2         84            6            4         1   \n",
       "1  2020年05月31日 22:29  赞         12            0            0         0   \n",
       "2  2020年05月31日 22:22  赞         33            0            0         0   \n",
       "3  2020年05月31日 22:20  赞         13            0            0         0   \n",
       "4  2020年05月31日 22:09  2         95           12            5         3   \n",
       "\n",
       "  anticipation_nrc disgust_nrc fear_nrc joy_nrc sadness_nrc surprise_nrc  \\\n",
       "0                2           1        3       2           4            2   \n",
       "1                0           0        0       0           0            0   \n",
       "2                1           0        1       0           0            0   \n",
       "3                0           0        0       0           0            0   \n",
       "4                5           1        3       4           4            0   \n",
       "\n",
       "  trust_nrc  \n",
       "0         3  \n",
       "1         0  \n",
       "2         0  \n",
       "3         0  \n",
       "4         2  "
      ]
     },
     "execution_count": 95,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tokophobia = pd.concat([tokophobia, emo_nrc_chn], axis=1)\n",
    "tokophobia.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f42b25ea-6d41-4005-96d7-4d1536f6b646",
   "metadata": {},
   "source": [
    "## 3.3 基于大连理工情感词典的情感分析"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 96,
   "id": "0a6c0f2e-4e5b-4b10-bd6d-d552348ec2c1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>词语</th>\n",
       "      <th>词性种类</th>\n",
       "      <th>情感分类</th>\n",
       "      <th>强度</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>脏乱</td>\n",
       "      <td>adj</td>\n",
       "      <td>NN</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>糟报</td>\n",
       "      <td>adj</td>\n",
       "      <td>NN</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>早衰</td>\n",
       "      <td>adj</td>\n",
       "      <td>NE</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>责备</td>\n",
       "      <td>verb</td>\n",
       "      <td>NN</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>贼眼</td>\n",
       "      <td>noun</td>\n",
       "      <td>NN</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   词语  词性种类 情感分类  强度\n",
       "0  脏乱   adj   NN   7\n",
       "1  糟报   adj   NN   5\n",
       "2  早衰   adj   NE   5\n",
       "3  责备  verb   NN   5\n",
       "4  贼眼  noun   NN   5"
      ]
     },
     "execution_count": 96,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dlut = pd.read_excel('DLUT-Emotion-Lexicon.xlsx', usecols=['词语', '词性种类', '情感分类', '强度'])\n",
    "dlut.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 99,
   "id": "0a0bb86a-8ffa-4160-9630-d70c9ac38e8b",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 整理情感词典\n",
    "Happy, Good, Surprise, Anger, Sad, Fear, Disgust  = [], [], [], [], [], [], []\n",
    "\n",
    "for idx, row in dlut.iterrows():\n",
    "    if row['情感分类'] in ['PA', 'PE']:\n",
    "        Happy.append(row['词语'])\n",
    "    if row['情感分类'] in ['PD', 'PH', 'PG', 'PB', 'PK']:\n",
    "        Good.append(row['词语']) \n",
    "    if row['情感分类'] in ['PC']:\n",
    "        Surprise.append(row['词语'])     \n",
    "    if row['情感分类'] in ['NA']:\n",
    "        Anger.append(row['词语'])    \n",
    "    if row['情感分类'] in ['NB', 'NJ', 'NH', 'PF']:\n",
    "        Sad.append(row['词语'])\n",
    "    if row['情感分类'] in ['NI', 'NC', 'NG']:\n",
    "        Fear.append(row['词语'])\n",
    "    if row['情感分类'] in ['NE', 'ND', 'NN', 'NK', 'NL']:\n",
    "        Disgust.append(row['词语'])\n",
    "Positive = Happy + Good + Surprise\n",
    "Negative = Anger + Sad + Fear + Disgust"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 101,
   "id": "71dff681-df9b-45bf-a207-b5ed17213bba",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>length_dlut</th>\n",
       "      <th>positive_dlut</th>\n",
       "      <th>negative_dlut</th>\n",
       "      <th>anger_dlut</th>\n",
       "      <th>disgust_dlut</th>\n",
       "      <th>fear_dlut</th>\n",
       "      <th>good_dlut</th>\n",
       "      <th>sadness_dlut</th>\n",
       "      <th>surprise_dlut</th>\n",
       "      <th>happy_dlut</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>84</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>12</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>33</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>13</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>95</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  length_dlut positive_dlut negative_dlut anger_dlut disgust_dlut fear_dlut  \\\n",
       "0          84             5             3          0            1         0   \n",
       "1          12             0             0          0            0         0   \n",
       "2          33             2             0          0            0         0   \n",
       "3          13             0             0          0            0         0   \n",
       "4          95             2             2          0            1         0   \n",
       "\n",
       "  good_dlut sadness_dlut surprise_dlut happy_dlut  \n",
       "0         3            2             1          1  \n",
       "1         0            0             0          0  \n",
       "2         2            0             0          0  \n",
       "3         0            0             0          0  \n",
       "4         1            1             0          1  "
      ]
     },
     "execution_count": 101,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "emo_dlut = pd.DataFrame(columns=['length_dlut', 'positive_dlut', 'negative_dlut',\n",
    "                                'anger_dlut', 'disgust_dlut', 'fear_dlut', 'good_dlut',\n",
    "                                'sadness_dlut', 'surprise_dlut', 'happy_dlut'])\n",
    "\n",
    "for dc in df_tokophobia.index:\n",
    "    positive, negative, anger, disgust, fear, sad, surprise, good, happy = 0, 0, 0, 0, 0, 0, 0, 0, 0\n",
    "    wordlist = list(jieba.cut(df_tokophobia[\"标题/微博内容\"][dc]))\n",
    "    wordset = set(wordlist)\n",
    "    wordfreq = []\n",
    "    for word in wordset:\n",
    "        freq = wordlist.count(word)\n",
    "        if word in Positive:\n",
    "            positive += freq\n",
    "        if word in Negative:\n",
    "            negative += freq\n",
    "        if word in Anger:\n",
    "            anger += freq\n",
    "        if word in Disgust:\n",
    "            disgust += freq\n",
    "        if word in Fear:\n",
    "            fear += freq\n",
    "        if word in Sad:\n",
    "            sad += freq\n",
    "        if word in Surprise:\n",
    "            surprise += freq\n",
    "        if word in Good:\n",
    "            good += freq\n",
    "        if word in Happy:\n",
    "            happy += freq\n",
    "            \n",
    "    emotion_info = {\n",
    "        'length_dlut': len(wordlist),\n",
    "        'positive_dlut': positive,\n",
    "        'negative_dlut': negative,\n",
    "        'anger_dlut': anger,\n",
    "        'disgust_dlut': disgust,\n",
    "        'fear_dlut': fear,\n",
    "        'good_dlut': good,\n",
    "        'sadness_dlut': sad,\n",
    "        'surprise_dlut': surprise,\n",
    "        'happy_dlut': happy\n",
    "    }\n",
    "    \n",
    "    emo_info = pd.DataFrame([emotion_info])\n",
    "    emo_dlut = pd.concat([emo_dlut, emo_info], ignore_index=True)\n",
    "    \n",
    "emo_dlut.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 103,
   "id": "7f4a9ebd-3b55-4fb8-87f4-175dcbbe9b08",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>文本</th>\n",
       "      <th>标题/微博内容</th>\n",
       "      <th>喜欢</th>\n",
       "      <th>altr</th>\n",
       "      <th>auth</th>\n",
       "      <th>care</th>\n",
       "      <th>dili</th>\n",
       "      <th>fair</th>\n",
       "      <th>general</th>\n",
       "      <th>libe</th>\n",
       "      <th>...</th>\n",
       "      <th>length_dlut</th>\n",
       "      <th>positive_dlut</th>\n",
       "      <th>negative_dlut</th>\n",
       "      <th>anger_dlut</th>\n",
       "      <th>disgust_dlut</th>\n",
       "      <th>fear_dlut</th>\n",
       "      <th>good_dlut</th>\n",
       "      <th>sadness_dlut</th>\n",
       "      <th>surprise_dlut</th>\n",
       "      <th>happy_dlut</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...</td>\n",
       "      <td>我真的极度恐婚恐育，源于我爸源于我前男友，还源于朋友身边的一些男性。哪怕今天女性在这个社会上...</td>\n",
       "      <td>2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>84</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...</td>\n",
       "      <td>从弹幕里学到了个新词-恐育。 ​</td>\n",
       "      <td>赞</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>12</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...</td>\n",
       "      <td>可能只有对象是王一博才能治好我的恐婚恐育...这个预告看的我头都大了，王一博，拜托你跟我成家...</td>\n",
       "      <td>赞</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>33</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 no帕布乐木iiio \\n             ...</td>\n",
       "      <td>今天也是十级恐婚和一百级恐育的一天 ​</td>\n",
       "      <td>赞</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>13</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>c 帮上头条 投诉 收藏 复制微博地址 no帕布乐木iiio \\n             ...</td>\n",
       "      <td>一想就停不下来。生孩子，对女性无论是身体，还是职业道路都是巨大的伤害！身体不说了，说说职业道...</td>\n",
       "      <td>2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>95</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 25 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                  文本  \\\n",
       "0  c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...   \n",
       "1  c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...   \n",
       "2  c 帮上头条 投诉 收藏 复制微博地址 月野璐璐子v \\n                 ...   \n",
       "3  c 帮上头条 投诉 收藏 复制微博地址 no帕布乐木iiio \\n             ...   \n",
       "4  c 帮上头条 投诉 收藏 复制微博地址 no帕布乐木iiio \\n             ...   \n",
       "\n",
       "                                             标题/微博内容 喜欢  altr  auth  care  \\\n",
       "0  我真的极度恐婚恐育，源于我爸源于我前男友，还源于朋友身边的一些男性。哪怕今天女性在这个社会上...  2   0.0   0.5   0.0   \n",
       "1                                   从弹幕里学到了个新词-恐育。 ​  赞   NaN   NaN   NaN   \n",
       "2  可能只有对象是王一博才能治好我的恐婚恐育...这个预告看的我头都大了，王一博，拜托你跟我成家...  赞   NaN   NaN   NaN   \n",
       "3                                今天也是十级恐婚和一百级恐育的一天 ​  赞   NaN   NaN   NaN   \n",
       "4  一想就停不下来。生孩子，对女性无论是身体，还是职业道路都是巨大的伤害！身体不说了，说说职业道...  2   0.0   0.0   0.5   \n",
       "\n",
       "   dili  fair  general  libe  ...  length_dlut  positive_dlut  negative_dlut  \\\n",
       "0   0.0   0.0      0.0   0.0  ...           84              5              3   \n",
       "1   NaN   NaN      NaN   NaN  ...           12              0              0   \n",
       "2   NaN   NaN      NaN   NaN  ...           33              2              0   \n",
       "3   NaN   NaN      NaN   NaN  ...           13              0              0   \n",
       "4   0.0   0.0      0.0   0.0  ...           95              2              2   \n",
       "\n",
       "   anger_dlut  disgust_dlut fear_dlut good_dlut sadness_dlut surprise_dlut  \\\n",
       "0           0             1         0         3            2             1   \n",
       "1           0             0         0         0            0             0   \n",
       "2           0             0         0         2            0             0   \n",
       "3           0             0         0         0            0             0   \n",
       "4           0             1         0         1            1             0   \n",
       "\n",
       "  happy_dlut  \n",
       "0          1  \n",
       "1          0  \n",
       "2          0  \n",
       "3          0  \n",
       "4          1  \n",
       "\n",
       "[5 rows x 25 columns]"
      ]
     },
     "execution_count": 103,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_tokophobia = pd.concat([df_tokophobia, emo_dlut], axis=1)\n",
    "df_tokophobia.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e5a47e6d",
   "metadata": {},
   "source": [
    "--------------------"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
